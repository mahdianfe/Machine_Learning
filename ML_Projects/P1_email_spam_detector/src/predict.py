# src/predict.py


#๐น ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ูุฏู ุฑู ุงูู ุฌุฏุฏ:
# ๐น ูุชู ุงูู ุฌุฏุฏ ุฑุง ุนุฏุฏ ูโฺฉูุฏ ู ูุชุฌู (ฐ ุง ฑ) ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.
# predict.py: ููุท ฺฉ ูุงฺูู ฺฉูฺฉ ุงุณุช ฺฉู ุชุงุจุน predict_email(text) ุฑุง ุชุนุฑู ูโฺฉูุฏ.
# ู ุงู ุชุงุจุน ฺฉ ูุชู ูโฺฏุฑุฏ ู ูุชุฌูโ ูพุดโุจู ุฑุง (ฐ ุง ฑ) ุจุฑูโฺฏุฑุฏุงูุฏ. ุฎูุฏุด ุจูโุชููุง ฺุฒ ฺุงูพ ููโฺฉูุฏ.
#  ุงูุง ูุงู predict_email.py: ฺฉ ุงุณฺฉุฑูพุช ูุงุจู ุงุฌุฑุง ุงุณุช ฺฉู ุงููโูุง ููููู ุฑุง ุจู ุชุงุจุน predict_email() ูโุฏูุฏ ู ูุชุฌู ุฑุง ฺุงูพ ูโฺฉูุฏ.

# ุชูุถุญ ุจุดุชุฑ
#  ูพุณ:
#     predict.py = ุชุงุจุน ููุทู ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุฌุงูุง ุฏฺฏุฑ.
#     predict_email.py = ุงุฌุฑุง ุนูู ู ููููู ุจุง ฺุงูพ ุฎุฑูุฌ.


from joblib import load

def predict_email(model_name, text):
    # ุจุงุฑฺฏุฐุงุฑ ูุฏู ู ุจุฑุฏุงุฑโุณุงุฒ ุจุฑ ุงุณุงุณ ูุงู ูุฏู
    model = load(f'models/{model_name}_classifier.pkl')
    vectorizer = load('models/vectorizer.pkl')
    # ฺูู ูุฑ ูุชู ุฑู ุจู ฺฉ ุจุฑุฏุงุฑ ูฺฺฏ (feature vector) ุชุจุฏู ูโฺฉูู.
    # ู ุฏุฑ ุฑุงุถุงุช ู ุงุฏฺฏุฑ ูุงุดูุ ุจู ฺูู ูุณุชโูุง ุงุฒ ุงุนุฏุงุฏ ยซุจุฑุฏุงุฑยป ฺฏูุชู ูโุดู.

    # ุชุจุฏู ูุชู ุงูู ุจู ูฺฺฏโูุง ุนุฏุฏ
    X = vectorizer.transform([text])

    #ูพุด ุจู
    prediction = model.predict(X)[0]
    # [0]
    # ุงู ุนู:
    #     ยซุงุฒ ุจู ููู ูพุดโุจูโูุงุ ููุท ุงููู (ู ุชููุง) ููุฑุฏ ุฑุง ุจุฑุฏุงุฑ.ยป
    # ฺุฑุงุ ฺูู ูุง ููุท ฺฉ ุงูู ุฑุง ุฏุงุฑู ูพุดโุจู ูโฺฉูู.
    # ูู ฺูู vectorizer.transform([text]) ุฎุฑูุฌโุงุด ฺฉ ุขุฑุงู ุจุง ฺฉ ููููู ุงุณุชุ
    # ูุฏู ูู ุฎุฑูุฌโุงุด ฺฉ ุขุฑุงู ุจุง ฺฉ ููุฏุงุฑ ุฎูุงูุฏ ุจูุฏ.

    # ุฏุฑ ุจุดุชุฑ ูุฏููุง ุฏู ฺฉูุงุณู model.predict(X) ฺฉ ุขุฑุงู ุจู ูุงู array([1])  ุง array([0])ุจุฑูฺฏุฑุฏููู
    #ุงฺฏุฑ array([0]) ุจุงุดุฏุ ุงููู ุนูุตุฑ ุตูุฑ ุงุณุช ู ุงฺฏุฑ array([1]) ุจุงุดุฏุ ุงููู ุนูุตุฑ ฺฉ ุงุณุช.
    # ุนู ุงฺฏุฑ ุงูู ุงุณูพู ุงุณุชุ ุฎุฑูุฌ ุจู ุดฺฉู array([1]) ุฎูุงูุฏ ุจูุฏ ู..


    # ุจุงุฒฺฏุดุช ูุชุฌู ูพุดโุจู
    return "This email **IS SPAM** โ " if prediction == 1 else "This email is **NOT SPAM** โ"
