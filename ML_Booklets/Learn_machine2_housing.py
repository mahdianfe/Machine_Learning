#---
---
"""
ูฺฉุชู ุจุฑุฏุงุฑ ุงุฒ ุณุงุช ูุง:

1. https://faradars.org/courses/machine-learning-using-python-fvpht0091

 2. ู ฺุช ุฌ ูพ ุช ู ุฌูู

 """



# !pip uninstall scikit-learn
# !pip install scikit-learn==1.2.0
# %%
import sklearn

sklearn.__version__
# %%
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# %% md
# Reading data
# %%
df = pd.read_csv("housing.csv")
# %%
df
# %%
df.info()
# %%
# ุชุนุฏุงุฏ ุจุฑุง ูุชุบุฑูุง ฺฉู ุฏุฑ ุฎุงูู ูุง ูุฌุงูุฑ ุงูุงููุณ ุงูุฏู
df.ocean_proximity.value_counts()
# %%
type(df)
# %%
df.describe()
# %%

# %% md

# %% md
 #_________________________________________________________________________________________________________________________________________
# Train and Test set 1
#### ุงู ููุน ุฌุฏุง ฺฉุฑุฏู ููุธูุฑ ูุง ูุณุช

# %%
# def shuffle_and_split_df(df, test_ratio):
#   np.random.seed(40)
#   random_indices = np.random.permutation(len(df))
#   test_set_size = int(len(df) * test_ratio)
#   test_random_indices = random_indices[:test_set_size]
#   train_random_indices = random_indices[test_set_size:]
#   return df.iloc[train_random_indices], df.iloc[test_random_indices]
# %%
# train_set, test_set = shuffle_and_split_df(df, 0.2)
# %%
# test_set
# %%
# from zlib import crc32
# %%
# crc32(np.int64(10))
# %%
# def is_identifier_in_test_set(identifier, test_ratio):
#   return crc32(np.int64(identifier)) < test_ratio*2**32
# %%
# def split_train_test_with_identifier_hash(df, test_ratio, identifier_column):
#   identifiers = df[identifier_column]
#   in_test_set = identifiers.apply(lambda id_: is_identifier_in_test_set(id_, test_ratio))
#   return df.loc[~in_test_set], df.loc[in_test_set]
# %%
# train_set, test_set = split_train_test_with_identifier_hash(df.reset_index(), 0.2, "index")
# %%
# df_with_identifier = df
# df_with_identifier["identifier"] = df["longitude"]*1000 + df["latitude"]
# df_with_identifier
# %%
# train_set, test_set = split_train_test_with_identifier_hash(df_with_identifier,
#                                                             0.2,
#                                                             "identifier")
# %%
# train_set
# %%
# test_set
# %% md
 #_________________________________________________________________________________________________________________________________________
# Train and Test set
#### ุงู ุฑูุด ูุฏ ูุธุฑ ูุงุณุช

# %%
from sklearn.model_selection import train_test_split

# %%
train_set, test_set = train_test_split(df, test_size=0.2, random_state=40)
# %%
train_set
# %%
test_set
# %%
# ูพุฏุง ฺฉุฑุฏู ููุฏุงุฑ Nan ุฏุฑ X
print(train_set.isnull().sum())
# %% md
 #_________________________________________________________________________________________________________________________________________
# ููุงุด ุงุทูุงุนุงุช ุฏุชุง ูุฑู
# %%

# ุฎูุฏ ูพุงูุฏุงุณ ูุช ูพูุงุช ูุจ ุฑุง ูุฑุงุฎุงู ูฺฉูู
df.hist(bins=40, figsize=(20, 9))
# %%
df["median_house_value"].value_counts()
# %% md
"""
# ูฺฉุชู ููู
# ุณุชูู ูุง ุชฺฉ ฺฉู ุงุฎุฑ ุจุนุถ ูููุฏุงุฑูุง ูุซู ูุฏู ููุณ ููู ูุฌูุฏ ุฏุงุฑุฏ
     ุงู ุนุฌุจู
     ุนู ุฑู ูุซูุง 500 ูุฒุงุฑ ุฏูุงุฑ ู ูพฺฉ ูุจูู 
     ุฏุฑ ุงุตู ุงููุฏู ููุงุฏุฑ ฺฉู ุงุฒ ฺฉ ุฌุง ุจู ุจุนุฏ ฺฉู ูุดุฏู ุฑุง ูุทุน ฺฉุฑุฏู 
     ู ููู ุงุนุฏุงุฏ ุจุฒุฑฺฏุชุฑ ุงุฒ 500 ูุฒุงุฑ ุฏูุงุฑ ุฑุง ุฑุง ุฑู 500ูุฒุงุฑ ุฏูุงุฑ ฺฏุฐุงุดุชู ู ุฌูุน ฺฉุฑุฏู
     ุงูุง ุงู ููุฏุงุฑ ุงุซุฑ ูฺฏุฐุงุฑู ุฏุฑ ุญุงูฺฉู ุงู ุชุงุฑฺฏุช ูุง ุงุณุช.
    ููุชููู ูุฏู ุจููุณู ฺฉู ุจุฑุง ุฎุงูู ูุง ุจุดุชุฑ ุงุฒ 500 ูุฒุงุฑ ุฏูุงุฑ ููุชููู ูพุด ุจู ุงูุฌุงู ุจุฏู
    ุจูุงุจุฑุงู ุจุงุฏ 500ูุฒุงุฑ ุฏูุงุฑ ุฑุง ุญุฐู ฺฉูู ุชุง ุฏุฑ ูพุด ุจู ูุฏู ุงุซุฑ ูฺฏุฐุงุฑู
"""

# %% md
 #_________________________________________________________________________________________________________________________________________
# ุฌููฺฏุฑ ุงุฒ ุณููพููฺฏ ุจุงุงุณ ุง ุณูฺฏุฑ ููููู ฺฏุฑ
"""
ูุซูุง ุฏู ููููู ุงูุง ู ุฎุงููู ุฏุงุฑู ฺฉู ุฏุฑุตุฏ ูุฌูุฏ ุงูุง ู ุฎุงูู 50 50 ูุณุช ู ฺฉ 80 ุงุณุช ุฎุจ ุงู ููููู ูุชุฌู ุฏุฑุณุช ุฑุง ุจู ูุง ููุฏู
ุจูุงุจุฑุงู ู ุงู ุจุฑุง ุงุณูพูุช ฺฉุฑุฏู ุชุณุช ู ุชุฑู ุงุฒ ูู ูฺฏูู ฺฉู 20 ุฏุฑุตุฏ ุงุฒ 80 ุฏุฑุตุฏ ุฎุงูู ุฑุง ุจุฑุฏุงุฑ ู 20 ุฏุฑุตุฏ ุงุฒ 20 ุฏุฑุตุฏ ุงูุง ุฑุง ุจุฑุฏุงุฑ ฺฉู ุณูฺฏุฑ ุงุชูุงู ููุชู 
"""

#### ุฑุงู ุญู: ุทุจูู ุจูุฏ ููููู


#### ุฑูุด:
####  ุงูู. ุฑู ููููู ุฎูุฏูุงู ุทุจูู ุจูุฏ ุงูุฌุงู ุฏูู
#### ู ุจ. ุณูพุณ ุชุณุช ู ุชุฑู ุฑุง ูุฌุฏุฏ ุงู ุจุงุฑ ุจุฑุง ฺฉุชฺฏูุฑ ุง ฺฉู ุงุฌุงุฏ ฺฉุฑุฏู ุงุฒ ูู ุฌุฏุง ูฺฉูู
#### ู ุฌ. ุญุฐู ุณุชูู ฺฉู ุจุฑุง ุทุจูู ุจูุฏ ุงุฌุงุฏ ฺฉุฑุฏู ุจูุฏู

# %% md
####  ุงูู. ุฑู ููููู ุฎูุฏูุงู ุทุจูู ุจูุฏ ุงูุฌุงู ุฏูู
# %%
#
df["median_house_value_categories"] = pd.cut(df["median_house_value"],
                                             bins=[0.0, 100000., 150000., 200000., 250000., 500001.],
                                             labels=[1, 2, 3, 4, 5])
df
# %%
df["median_house_value_categories"].value_counts()
#  ฺฉุชฺฏูุฑ ุฑุง ุจุฑ ุงุณุงุณ ูุงฺฉุณูู ูุฑุชุจ ูฺฉูู
# %%
df["median_house_value_categories"].value_counts().sort_index().plot.bar(grid=True)
# ุนุจุงุฑุช sort_index() ุจุงุนุซ ูุดู ฺฉู ุฏฺฏู ุจุฑ ุงุณุงุณ ูุงฺฉุณูู ูุดุงู ูุฏู ู ุจุฑุงุณุงุณ ุงูุฏุณ ูุดุงู ุฏูุฏ
# %%
# ูพุฏุง ฺฉุฑุฏู ููุฏุงุฑ Nan ุฏุฑ y
print(train_set['median_house_value'].isnull().sum())
# ุงฺฏุฑ ุฎุฑูุฌ ุงู ฺฉุฏ ุนุฏุฏ ุจุฒุฑฺฏุชุฑ ุงุฒ 0 ุจุงุดุฏุ ุจู ุงู ูุนู ุงุณุช ฺฉู ุณุชูู median_house_value ุฏุฑ ูุฌููุนู ุฏุงุฏู ุขููุฒุด ุดูุง ุญุงู ููุงุฏุฑ NaN ุงุณุช
# ููุช ุดูุง ูุชุฏ .sum() ุฑุง ุฑู ฺฉ ุณุฑ (Series) ุจูู ุงุนูุงู ูโฺฉูุฏุ ูพุงุชูู ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ููุงุฏุฑ True ุฑุง ุจู 1 ู ููุงุฏุฑ False ุฑุง ุจู 0 ุชุจุฏู ูโฺฉูุฏ. ุณูพุณุ ุงู ููุงุฏุฑ 0 ู 1 ุจุง ูู ุฌูุน ูโุดููุฏ.
# %%
# ุฌุงฺฏุฒู NaN ุจุง ุตูุฑ ุฏุฑ ุชุฑู  ู ุชุณุช
train_set['total_bedrooms'].fillna(0)
test_set['total_bedrooms'].fillna(0)

# # ูุญุงุณุจู ูุงูู ุงุฒ ูุฌููุนู ุขููุฒุด ู ุฌุงฺฏุฒู NaN ุจุง ูุงูู ุฏุฑ ุชุณุช ู ุชุฑู
# median_bedrooms_train = train_set['total_bedrooms'].median()
# train_set['total_bedrooms'].fillna(median_bedrooms_train)
# test_set['total_bedrooms'].fillna(median_bedrooms_train)
#
# # ุงฺฏุฑ ูโุฎูุงูุฏ ุงุฒ ูุงูฺฏู ุงุณุชูุงุฏู ฺฉูุฏุ ุจู ุฌุง .median() ุงุฒ .mean() ุงุณุชูุงุฏู ฺฉูุฏ
# mean_bedrooms_train = train_set['total_bedrooms'].mean()
# train_set['total_bedrooms'].fillna(mean_bedrooms_train)
# test_set['total_bedrooms'].fillna(mean_bedrooms_train)
# %% md

# %% md

# ู ุจ.  ุชุณุช ู ุชุฑู ุฑุง ุจุฑุง ฺฉุชฺฏูุฑ ูุฌุฏุฏุง ุงุฒ ูู ุฌุฏุง ูฺฉูู

# %%
str_train_set, str_test_set = train_test_split(df,
                                               test_size=0.2,
                                               stratify=df["median_house_value_categories"],
                                               random_state=40)
# df  ููุงู X ูุง ู stratify ููุงู ุณุชูู ูุง ุงุณุช
#  ฺฉู ููุฏุงุฑ stratify ุฑุง ุจุฑุงุจุฑ ุจุง ุณุชูู ูุฑุงุฑ ูุฏูู ฺฉู ุฑููุด ฺฉุชฺฏูุฑ ุงุฌุงุฏ ฺฉุฑุฏู
# %%
str_train_set["median_house_value_categories"].value_counts() / len(str_train_set)
# %% md
"""
ุจุงุฏ ูุฑุญูู ุจู ูุฑุญูู ุจุฑุฑุณ ฺฉูู:

    str_train_set["median_house_value_categories"].value_counts(): ุงู ูุณูุช ุงุฒ ฺฉุฏ ุชุนุฏุงุฏ ุฑุฏูโูุง ูุฑุจูุท ุจู ูุฑ ุฏุณุชู ููุญุตุฑ ุจู ูุฑุฏ ุฏุฑ ุณุชูู median_house_value_categories ุฑุง ุฏุฑ ูุฌููุนู ุขููุฒุด ุดูุงุฑุด ูโฺฉูุฏ. ูุชุฌู ฺฉ ุณุฑ (Series) ุงุณุช ฺฉู ุฏุฑ ุขู ุงูุฏุณโูุง ูุงู ุฏุณุชูโูุง ู ููุงุฏุฑ ุชุนุฏุงุฏ ูููููโูุง ูุฑุจูุท ุจู ูุฑ ุฏุณุชู ูุณุชูุฏ.

    / len(str_train_set): ุงู ูุณูุช ุงุฒ ฺฉุฏ ูุชุฌู value_counts() ุฑุง ุจุฑ ุชุนุฏุงุฏ ฺฉู ูููููโูุง ููุฌูุฏ ุฏุฑ ูุฌููุนู ุขููุฒุด (len(str_train_set)) ุชูุณู ูโฺฉูุฏ. ุงู ุชูุณู ุจุงุนุซ ูโุดูุฏ ฺฉู ุชุนุฏุงุฏ ูููููโูุง ูุฑ ุฏุณุชู ุจู ฺฉ ูุณุจุช ุง ุฏุฑุตุฏ ุชุจุฏู ุดูุฏ.

ูุซุงู:

ูุฑุถ ฺฉูุฏ ุฏุฑ ูุฌููุนู ุขููุฒุด (str_train_set) 1000 ููููู ูุฌูุฏ ุฏุงุฑุฏ ู ุณุชูู median_house_value_categories ุจู ุตูุฑุช ุฒุฑ ุงุณุช:

    ุฏุณุชู 1: 200 ููููู
    ุฏุณุชู 2: 300 ููููู
    ุฏุณุชู 3: 250 ููููู
    ุฏุณุชู 4: 150 ููููู
    ุฏุณุชู 5: 100 ููููู

ุฏุฑ ุงู ุตูุฑุช:

    str_train_set["median_house_value_categories"].value_counts() ูุชุฌูโุง ูุดุงุจู ุฒุฑ ุฎูุงูุฏ ุฏุงุดุช:

    1    200
    2    300
    3    250
    4    150
    5    100
    Name: median_house_value_categories, dtype: int64

    len(str_train_set) ุจุฑุงุจุฑ ุจุง 1000 ุฎูุงูุฏ ุจูุฏ.

    ูุฑููู str_train_set["median_house_value_categories"].value_counts()/len(str_train_set) ูุชุงุฌ ุฒุฑ ุฑุง ุจู ุฏุณุช ุฎูุงูุฏ ุฏุงุฏ:

    1    0.20
    2    0.30
    3    0.25
    4    0.15
    5    0.10
    Name: median_house_value_categories, dtype: float64

    ุงู ูุดุงู ูโุฏูุฏ ฺฉู:
        20% ุงุฒ ูููููโูุง ูุฌููุนู ุขููุฒุด ุฏุฑ ุฏุณุชู 1 ูุฑุงุฑ ุฏุงุฑูุฏ.
        30% ุงุฒ ูููููโูุง ูุฌููุนู ุขููุฒุด ุฏุฑ ุฏุณุชู 2 ูุฑุงุฑ ุฏุงุฑูุฏ.
        25% ุงุฒ ูููููโูุง ูุฌููุนู ุขููุฒุด ุฏุฑ ุฏุณุชู 3 ูุฑุงุฑ ุฏุงุฑูุฏ.
        15% ุงุฒ ูููููโูุง ูุฌููุนู ุขููุฒุด ุฏุฑ ุฏุณุชู 4 ูุฑุงุฑ ุฏุงุฑูุฏ.
        10% ุงุฒ ูููููโูุง ูุฌููุนู ุขููุฒุด ุฏุฑ ุฏุณุชู 5 ูุฑุงุฑ ุฏุงุฑูุฏ.

##### ูุฏู ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุงู ูุฑููู:

 ##### ุงู ูุฑููู ูุนูููุงู ุจุฑุง ุงู ููุถูุน ุงุณุชูุงุฏู ูโุดูุฏ ฺฉู ุขุง ุชูุฒุน ุฏุณุชูโูุง ุฏุฑ ูุฌููุนู ุขููุฒุด ุจุง ุชูุฒุน ุฏุณุชูโูุง ุฏุฑ ุฏุชุงูุฑู ุงุตู ุง ูุฌููุนู ุขุฒูุงุด ูุทุงุจูุช ุฏุงุฑุฏ ุง ุฎุฑ.
  ##### ุงู ุงูุฑ ุจู ูฺู ุฒูุงู ููู ุงุณุช ฺฉู ุงุฒ ุฑูุด stratify ุฏุฑ train_test_split ุงุณุชูุงุฏู ูโฺฉูุฏุ 
 ##### ุฒุฑุง ูุฏู stratify ุงู ุงุณุช ฺฉู ุงุทููุงู ุญุงุตู ุดูุฏ ฺฉู ูุณุจุช ุฏุณุชูโูุง ุฏุฑ ูุฌููุนูโูุง ุขููุฒุด ู ุขุฒูุงุด ูุดุงุจู ูุณุจุช ุขูโูุง ุฏุฑ ุฏุชุงูุฑู ุงุตู ุงุณุช.
"""
# %% md
# ุฌ. ุญุฐู ุณุชูู ฺฉู ุจุฑุง ุทุจูู ุจูุฏ ุงุฌุงุฏ ฺฉุฑุฏู ุจูุฏู

# %%
str_train_set = str_train_set.drop("median_house_value_categories", axis=1)
# axis=1 ุนู ุณุชูู ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑ
str_test_set = str_test_set.drop("median_house_value_categories", axis=1)
# %%
str_train_set
# %% md
 #_________________________________________________________________________________________________________________________________________
# Visualize
# %%
train = str_train_set
# %%
ax = sns.scatterplot(data=train,
                     x="longitude",
                     y="latitude",
                     size="population",
                     alpha=0.2,
                     hue="median_house_value")
sns.move_legend(ax, "upper left", bbox_to_anchor=(1, 1))
# %% md
 #_________________________________________________________________________________________________________________________________________
# Correlations
# %% md
"""
     ฑ. ฺฉูุฑูุดู (Correlation) ุฏุฑ ูุงุดู ูุฑููฺฏ ฺุณุชุ

    ฺฉูุฑูุดู (ููุจุณุชฺฏ) ูุนุงุฑ ุงุณุช ฺฉู ูุดุงู ูโุฏูุฏ ฺฺฏููู ุฏู ูุชุบุฑ ุจุง ฺฉุฏฺฏุฑ ุฑุงุจุทู ุฏุงุฑูุฏ.
    ๐น ุขุง ููุช ููุฏุงุฑ ฺฉ ูุชุบุฑ ุฒุงุฏ ุดูุฏุ ูุชุบุฑ ุฏฺฏุฑ ูู ุฒุงุฏ ูโุดูุฏุ
    ๐น ุขุง ููุช ููุฏุงุฑ ฺฉ ูุชุบุฑ ุฒุงุฏ ุดูุฏุ ููุฏุงุฑ ูุชุบุฑ ุฏฺฏุฑ ฺฉู ูโุดูุฏุ
    ๐น ุง ูฺ ุงุฑุชุจุงุท ูุดุฎุต ุจู ุงู ุฏู ูุชุบุฑ ูุฌูุฏ ูุฏุงุฑุฏุ

    -----------------------------------------------------
ฺฉูุฑูุดู ุฏุฑ ูุงุดู ูุฑููฺฏ ฺู ุงุณุชูุงุฏูโูุง ุฏุงุฑุฏุ
๐ ฑ. ุงูุชุฎุงุจ ูฺฺฏโูุง (Feature Selection)

    ุงฺฏุฑ ุฏู ูฺฺฏ (ูุซูุงู ุณู ู ูุฏ) ููุจุณุชฺฏ ุจุณุงุฑ ุฒุงุฏ ุฏุงุดุชู ุจุงุดูุฏุ ูโุชูุงูู ฺฉ ุงุฒ ุขูโูุง ุฑุง ุญุฐู ฺฉูู.
    ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ูุฏู ุณุงุฏูโุชุฑ ู ุณุฑุนโุชุฑ ุดูุฏ.

๐ ฒ. ฺฉุดู ุฑูุงุจุท ุจู ุฏุงุฏูโูุง

    ูุซูุงู ุฏุฑ ุชุญูู ุฏุงุฏูโูุง ูพุฒุดฺฉุ ุขุง ูุตุฑู ุฒุงุฏ ููฺฉ ุจุงุนุซ ุงูุฒุงุด ูุดุงุฑ ุฎูู ูโุดูุฏุ
    ูุฏูโูุง ุงุฏฺฏุฑ ูุงุดู ูโุชูุงููุฏ ุงู ุงุฑุชุจุงุทุงุช ุฑุง ุจุฑุฑุณ ฺฉููุฏ.

๐ ณ. ุชุดุฎุต ูุดฺฉูุงุช ุฏุงุฏูโูุง (Multicollinearity)

    ุงฺฏุฑ ฺูุฏ ูุชุบุฑ ุฎู ููุจุณุชู ุจุงุดูุฏุ ูุฏู ููฺฉู ุงุณุช ุฏฺุงุฑ ูุดฺฉู ุดูุฏ ู ูพุดโุจูโูุง ูุงุฏุฑุณุช ุจุฏูุฏ.
    ุฏุฑ ุงู ุญุงูุชุ ุจูุชุฑ ุงุณุช ูฺฺฏโูุง ููุจุณุชู ุฑุง ุญุฐู ฺฉูู.
"""
# %%
# train.corr()["median_house_value"]
# ฺูู ุณุชูู ocean_proximity ุนุฏุฏ ูุณุช ุฎุทุง ูุฏู
# %%
print(train.dtypes)

# %%
# ูุญุงุณุจู ฺฉูุฑูุดู ุง ููุจุณุชฺฏ (ุจุง ุฏุฑ ูุธุฑ ูฺฏุฑูุชู ุณุชูููุง ุบุฑ ุนุฏุฏ)
train.select_dtypes(include=["number"]).corr()["median_house_value"]
# ุงู ฺฉุฏ ุชุถูู ูโฺฉูุฏ ฺฉู ููุท ุงุนุฏุงุฏ ุฏุฑ corr() ุงุณุชูุงุฏู ุดุฏูโุงูุฏ.

# %%
sns.scatterplot(data=train,
                x="median_income",
                y="median_house_value",
                alpha=0.2)
# %% md
###### ุฏุฑ ุดฺฉู ุจุงูุง ุฎุทูุง ุงูู ุฑุง ูุจูู ฺฉู ุจูุชุฑู ุงููุง ุญุฐู ุจุดู ุงุญุชูุงูุง ุงู ุงุนุฏุงุฏ ุฏุณุช ุฏุฑุณุช ุดุฏูุฏ
# %% md
# Attribute combinations

"""
Attribute Combinations ุนู ุณุงุฎุช ูฺฺฏโูุง ุฌุฏุฏ (New Features) ุงุฒ ุชุฑฺฉุจ ูฺฺฏโูุง ููุฌูุฏ.
โ ูุฏู: ฺฉูฺฉ ุจู ูุฏู ุจุฑุง ุงุฏฺฏุฑ ุจูุชุฑ ุงูฺฏููุง ูพููุงู ุฏุฑ ุฏุงุฏูโ

"""
# %%
# ูุญุงุณุจู ูุณุจุช ฺฉ ุจู ุฏฺฏุฑ
# ููู ุงูฺฉุงุฑุง ุฑู ุฑู ุชุณุช ูู ุงูุฌุงู ูุฏู ุงูุง ูุนูุง ุชุฑู ุฑู ุงูุฌุงู ุฏุงุฏู
#  ุงู ูุณุจุชูุง ฺฉู ุฏุงุฑู ุงุฌุงุฏ ูฺฉูู ุฏุฑ ูุงูุน ุฏุงุฑูุฏ ู ุณุชูู ุจู ุฌุฏููููู ุงุถุงูู ูฺฉูู

# ูุญุงุณุจู ุงุชุงููุง ฺฉ ุฎุงูู ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑู ุจูุชุฑ ุงุฒ ุงูู ฺฉู ฺฉู ุงุชุงููุง ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑู
train["rooms_per_house"] = train["total_rooms"] / train["households"]

#  ูุณุจุช ุงุชุงู ุฎูุงุจ ุจู ฺฉู ุงุชุงููุง ฺูุฏุฑ ุงุณุช
train["bedrooms_ratio"] = train["total_bedrooms"] / train["total_rooms"]

# ุง ูุซูุง ุฏุฑูุฑ ฺฉุฏุงู ุงุฒ ุฎุงูู ูุง ฺูุฏ ููุฑ ุงุฏู ูุณุชูุฏ
train["people_per_house"] = train["population"] / train["households"]
train
# %%
# ูุญุงุณุจู ฺฉูุฑูุดู ุง ููุจุณุชฺฏ (ุจุง ุฏุฑ ูุธุฑ ูฺฏุฑูุชู ุณุชูููุง ุบุฑ ุนุฏุฏ)
train.select_dtypes(include=["number"]).corr()["median_house_value"]
# ุงู ฺฉุฏ ุชุถูู ูโฺฉูุฏ ฺฉู ููุท ุงุนุฏุงุฏ ุฏุฑ corr() ุงุณุชูุงุฏู ุดุฏูโุงูุฏ.

# %% md
 #_________________________________________________________________________________________________________________________________________
# Prepare Data
##### ุงูุงุฏู ฺฉุฑุฏู ุฏุงุฏู ุจุฑุง ุงุฏฺฏุฑ ูุฏููุง ูุงุดู
# %%
train_features = train.drop("median_house_value", axis=1)
# ูฺฺฏโูุง ูุฏู (Feature Matrix) ุง ููุงู Xุ ุนู ูุชุบุฑูุง ูุณุชูู

train_target = train["median_house_value"]
# ุจุฑฺุณุจ ูุฏู (Target Variable) ุง ููุงู  yุ ุนู ูุชุบุฑ ูุงุจุณุชู ฺฉู ูุฏู ุจุงุฏ ุขู ุฑุง ูพุดโุจู ฺฉูุฏ

train_target
# %% md
## Data cleaning ==> using Pandas library
# %%
# train_features.info()
#  ุฏุฑ ุฎุฑูุฌ entries ุนู ุชุนุฏุงุฏ ุณุทุฑูุง
# %% md

# %%
# ุจุฑุง ุญุฐู ฺฉุฑุฏู ุณุชูู ฺฉู ูุงุฒ ูุณุช ู ููุฏุงุฑ Nan ุฏุงุฑุฏ
# remove rows with NA values
# train_features.dropna(subset=["total_bedrooms"]).info()
# %%
## train_features_with_imputed_na_values
# total_bedrooms_median = train_features["total_bedrooms"].median()
# train_features["total_bedrooms"] = train_features["total_bedrooms"].fillna(total_bedrooms_median)
# %%
# train_features.info()
# %%
# train_features["bedrooms_ratio"] = train_features["total_bedrooms"]/train_features["total_rooms"]
# %%
# train_features.info()
# %% md
 #_________________________________________________________________________________________________________________________________________
# Data cleaning ==> using slklearn library
# ุงุตูุงุญ ุฏุชุง _ ุจุฑุง ุงุฏฺฏุฑ ูุงุดู _ ุชูุณุท ฺฉุชุงุจุฎุงูู ุณุงฺฉุช ูุฑู

# %% md
# 1
# sklearn impute
# %%
from sklearn.impute import SimpleImputer

# %%
simple_imputer = SimpleImputer(strategy="median")
# ุงุณุชุฑุงุชฺ ุฑุง ุชุนู ูฺฉูู ฺฉู ูุซูุง ุฌุง ููุงุฏุฑ ููุ ูุงูู ุจฺฏุฐุงุฑู
# ุชูุฌู ุดูุฏ ฺฉู ูุนูุง ูุฏู ุฑุง ุณุงุฎุชู ู ูููุฒ ุฏุงุฏู ุง ุจูุด ูุฏุงุฏู
# %%
train_features = train.drop("median_house_value", axis=1)
# ูฺฺฏโูุง ูุฏู (Feature Matrix) ุง ููุงู Xุ ุนู ูุชุบุฑูุง ูุณุชูู

train_target = train["median_house_value"]
# ุจุฑฺุณุจ ูุฏู (Target Variable) ุง ููุงู  yุ ุนู ูุชุบุฑ ูุงุจุณุชู ฺฉู ูุฏู ุจุงุฏ ุขู ุฑุง ูพุดโุจู ฺฉูุฏ

train_features.info()
# %%
# ููู : ฺูู ุจุนุถ ุณุชูููุง ุนุฏุฏ ูุณุช ููุท ุณุชูููุง ฺฉู ุนุฏุฏ ูุณุชูุฏ ุฑุง ุงูุชุฎุงุจ ูฺฉูู
train_features_numeric = train_features.select_dtypes(include=[np.number])
train_features_numeric.info()
# %%
simple_imputer.fit(train_features_numeric)
# ููุฏุงุฑ ุฌุงฺฏุฒู ูู ุฑุง ูุญุงุณุจู ู ุฐุฎุฑู ูฺฉูุฏ
# %%
# ุนุจุงุฑุช ฺฉ ุงุชุฑุจูุช ุจุฑุง ุงููพูุช  ุงุณุช ฺฉู  statistics_
# ููุงุด ููุฏุงุฑู ุฌุงฺฏุฒู ุดุฏู ุจุฑุง ูุฑ ุณุชูู
simple_imputer.statistics_

# %%
# ููุฏุงุฑูุง ูู ุฑุง ุจุง ููุฏุงุฑ ูุญุงุณุจู ุดุฏู ุฌุงฺฏุฒู ูฺฉูุฏ
simple_imputer.transform(train_features_numeric).shape

# ๐ก ูพุณ statistics_ ููุท ููุฏุงุฑูุง ฺฉู fit() ุงุฏ ฺฏุฑูุชู ุฑุง ูุดุงู ูโุฏูุฏุ ูู transform() ูุงูุนุงู ุฏุงุฏูโูุง ุฑุง ุชุบุฑ ูโุฏูุฏ.
# %%
# ุงู ฺฉุฏ ุฏุงุฏูโูุง ุนุฏุฏ train_features_numeric ุฑู ฺฉู ููุงุฏุฑ ุงุฒโุฏุณุชโุฑูุชู (NaN) ุฏุงุดุชูุ ุจุง ููุฏุงุฑ ูุงูู (ุง ูุฑ ุงุณุชุฑุงุชฺ ุฏฺฏุฑ ฺฉู ุฏุฑ simple_imputer ุชูุธู ฺฉุฑุฏู) ุฌุงฺฏุฒู ูโฺฉูู ู ุฏูุจุงุฑู ุฏุฑ ฺฉ ุฏุชุงูุฑู ุฌุฏุฏ ุฐุฎุฑู ูโฺฉูู.
train_features_numeric = pd.DataFrame(simple_imputer.transform(train_features_numeric),
                                      columns=train_features_numeric.columns,
                                      index=train_features_numeric.index)
# ุฏููู ุฏุงุฏู ฺฉุงูููุฒ ู ุงูุฏฺฉุณ ุงู ุงุณุช ฺฉู ุณุชูู ู ุงูุฏฺฉุณ ุฑุง ุงุฒ ุฏุชุงูุฑู ุงุตู ุจฺฏุฑุฏ
# ู ุงูฺฉุงุฑ ุจุงุนุซ ูุดู ฺฉู ุฑุฏู ูุง ุฌุฏุฏ ููุงู ูุงู ุณุชูู ู ุงูุฏฺฉุณ ูุจู ุฑุง ุฏุงุดุชู ุจุงุดุฏ

# %%
train_features_numeric
# %% md
# Consistency
# estimator
# transformer
# predictors

# Inspection

# Composition
# %% md
"""
โ  Consistency (ฺฉููุงุฎุช) ุฏุฑ scikit-learn ฺุณุชุ

    ๐น scikit-learn ฺฉ ุงุณุชุงูุฏุงุฑุฏ ูุดุฎุต ุจุฑุง ฺฉูุงุณโูุง ูุฎุชูู ุงุฏฺฏุฑ ูุงุดู ุฏุงุฑุฏ ุชุง ฺฉุงุฑ ฺฉุฑุฏู ุจุง ุขูโูุง ุฑุงุญุช ู ูุงุจู ูพุดโุจู ุจุงุดุฏ. ุงู ูฺฺฏ ุฑุง Consistency (ฺฉููุงุฎุช) ูโูุงููุฏ.
    ๐น ุนู ููู ูุฏูโูุง (estimatorsุ transformersุ predictors) ฺฉ ุณุงุฎุชุงุฑ ฺฉู ุฏุงุฑูุฏ ู ุงุฒ ูุชุฏูุง ฺฉุณุงู ูพุฑู ูโฺฉููุฏ.

    ๐ ูฺฺฏโูุง Consistency:
    โ ุชูุงู ูุฏูโูุง (estimators) ุฏุงุฑุง fit() ูุณุชูุฏ (ุขููุฒุด ูุฏู) .
    ุจุนุถ estimators ูุง ูุชูุงููุฏ ุชุฑูุณูุฑู ูู ุจุงุดูุฏ ูุซู  SimpleImputer . ุฏุฑุณุชูุ  
    โ ูุฏูโูุง ูพุดโุจู (predictors) ุฏุงุฑุง predict() ูุณุชูุฏ (ูพุดโุจู ุฎุฑูุฌ)
    โ ูุฏูโูุง ุชุจุฏู (transformers) ุฏุงุฑุง transform() ูุณุชูุฏ (ุชุจุฏู ุฏุงุฏูโูุง)
    โ ูุฑ ูุฏู ูุฌููุนูโุง ุงุฒ hyperparameters ุฏุงุฑุฏ ฺฉู ุฏุฑ ููฺฏุงู ุงุฌุงุฏ ุดุก ุชูุธู ูโุดููุฏ.


โ 1. estimator (ุชุฎููโฺฏุฑ) ฺุณุชุ

    Estimator ุจู ูุฑ ูุฏู ุงุฏฺฏุฑ ูุงุดู ุฏุฑ scikit-learn ฺฏูุชู ูโุดูุฏ ฺฉู ุฏุงุฑุง fit() ุงุณุช.
    โ ูุฏูโูุง ุฑฺฏุฑุณููุ ุทุจููโุจูุฏุ ู ุฎูุดูโุจูุฏ ููฺฏ estimator ูุณุชูุฏ.
    โ ูุซุงู: LinearRegression, RandomForestClassifier, KMeans


โ 2. transformer (ุชุจุฏูโฺฉููุฏู) ฺุณุชุ

    ๐น transformer ูุฏู ุงุณุช ฺฉู ุฑู ุฏุงุฏูโูุง ูพุฑุฏุงุฒุด ุงูุฌุงู ูโุฏูุฏ ู ุขูโูุง ุฑุง ุชุบุฑ ูโุฏูุฏุ ูู ูพุดโุจู (predict()) ุงูุฌุงู ููโุฏูุฏ.
    ๐น ููู transformers ุฏุงุฑุง ูุชุฏ fit_transform() ูุณุชูุฏ.

    โ ูุซุงูโูุง:
        StandardScaler: ุฏุงุฏูโูุง ุฑุง ุงุณุชุงูุฏุงุฑุฏ ูโฺฉูุฏ.
        PCA: ุชุนุฏุงุฏ ูฺฺฏโูุง ุฑุง ฺฉุงูุด ูโุฏูุฏ.
        SimpleImputer: ููุฏุงุฑูุง NaN ุฑุง ุฌุงฺฏุฒู ูโฺฉูุฏ.

    โ ูุชุฌู:
    StandardScaler ฺฉ transformer ุงุณุช ฺฉู ุฏุงุฏูโูุง ุฑุง ุงุณุชุงูุฏุงุฑุฏ ูโฺฉูุฏ.
    ฺูู ูพุดโุจู ุงูุฌุงู ููโุฏูุฏุ predict() ูุฏุงุฑุฏ.


โ 3. predictor (ูพุดโุจูโฺฉููุฏู) ฺุณุชุ

    ๐น predictor ุจู ูุฏู ฺฏูุชู ูโุดูุฏ ฺฉู ูโุชูุงูุฏ ุฑู ุฏุงุฏูโูุง ุฌุฏุฏ ูพุดโุจู ุงูุฌุงู ุฏูุฏ.
    ๐น ููู predictors ุฏุงุฑุง predict() ูุณุชูุฏ.

    โ ูุซุงูโูุง:
        ุฑฺฏุฑุณูู: LinearRegression, SVR
        ุทุจููโุจูุฏ: LogisticRegression, RandomForestClassifier


โ 4. Inspection (ุจุงุฒุฑุณ ูุฏู) ฺุณุชุ

    ๐น Inspection ุนู ูุงุจูุช ุจุฑุฑุณ ู ุชุญูู ูฺฺฏโูุง ูุฏู ุจุนุฏ ุงุฒ ุขููุฒุด.
    ๐น scikit-learn ุงุจุฒุงุฑูุง ุงุฑุงุฆู ูโุฏูุฏ ุชุง ุจูููู ูุฏู ฺฺฏููู ุชุตูู ูโฺฏุฑุฏ.

    โ ูุซุงูโูุง:
        coef_ ุฏุฑ LinearRegression โ ูุดุงู ูโุฏูุฏ ฺฉุฏุงู ูฺฺฏโูุง ูููโุชุฑูุฏ.
        feature_importances_ ุฏุฑ RandomForest โ ูุฒุงู ุงููุช ูุฑ ูฺฺฏ ุฏุฑ ูุฏู ุฑุง ูุดุงู ูโุฏูุฏ.

    โ ูุชุฌู:
        ูุดุงู ูโุฏูุฏ ฺฉู ฺฉุฏุงู ูุชุบุฑูุง ุจุดุชุฑ ุฏุฑ ูพุดโุจู ููุด ุฏุงุฑูุฏ


โ 5. Composition (ุชุฑฺฉุจ ูุฏูโูุง) ฺุณุชุ

    ๐น Composition ุนู ุชุฑฺฉุจ ฺูุฏู ูุฏู ุงุฏฺฏุฑ ูุงุดู ุจุฑุง ุจูุจูุฏ ุนููฺฉุฑุฏ.
    ๐น ุฏู ููุน ุฑูุด ููู ุฏุฑ Composition:
    1๏ธโฃ Ensemble Learning (ุงุฏฺฏุฑ ฺฏุฑูู): ุชุฑฺฉุจ ฺูุฏู ูุฏู ุจุฑุง ุจูุจูุฏ ุฏูุช

        ูุซุงูโูุง: RandomForest, AdaBoost, VotingClassifier
        2๏ธโฃ Pipeline (ูููู ูพุฑุฏุงุฒุด): 

"""
# %% md
 #_________________________________________________________________________________________________________________________________________
# categorical features

"""
     - ูฺฺฏโูุง ุฏุณุชูโุง (Categorical Features) ูุชุบุฑูุง ูุณุชูุฏ ฺฉู ููุฏุงุฑ ุขูโูุง ุจู ุฏุณุชูโูุง ูุดุฎุต ุชุนูู ุฏุงุฑุฏ ู ููุฏุงุฑูุง ุนุฏุฏ ูุฏุงุฑูุฏ.
     -ุงู ูฺฺฏโูุง ูุดุงูโุฏููุฏูโ ุจุฑฺุณุจโูุง ุง ฺฏุฑููโูุง ูุฌุฒุง ูุณุชูุฏุ ูู ููุงุฏุฑ ูพูุณุชู.
     -ุงู ููุงุฏุฑ ุงุนุฏุงุฏ ูุณุชูุฏุ ูพุณ ูุฏู ุงุฏฺฏุฑ ูุงุดู ููโุชูุงูุฏ ูุณุชูู ุงุฒ ุขูโูุง ุงุณุชูุงุฏู ฺฉูุฏ.
     -ูพุณ ุจุงุฏ ุขูโูุง ุฑุง ุจู ุฑูุดูุง ฺฉู ุฏุฑ ุฒุฑ ฺฏูุชู ูุดู ุจู ุนุฏุฏ ุชุจุฏู ฺฉูู.


-ุงููุงุน ูฺฺฏโูุง ุฏุณุชูโุง (Categorical Data Types):

    ุฏู ุฏุณุชู ูุฌูุฏ ุฏุงุฑุฏ: ุฏุงุฏูโูุง Nominal ูฺ ุฑุงุจุทูโ ุชุฑุชุจ ุจู ุฏุณุชูโูุง ูุฌูุฏ ูุฏุงุฑุฏุ ุงูุง ุฏุฑ ุฏุงุฏูโูุง Ordinalุ ุชุฑุชุจ ููู ุงุณุช.


-ฺุฑุง ุจุงุฏ ูฺฺฏโูุง ุฏุณุชูโุง ุฑุง ุชุจุฏู ฺฉููุ

    ูุฏูโูุง ุงุฏฺฏุฑ ูุงุดู ูุงููุฏ ุฑฺฏุฑุณูู ุฎุท ู ุฌูฺฏู ุชุตุงุฏู ููุท ูโุชูุงููุฏ ุจุง ุฏุงุฏูโูุง ุนุฏุฏ ฺฉุงุฑ ฺฉููุฏ.
    ูพุณ ุงฺฏุฑ ูฺฺฏโูุง ุฏุณุชูโุง ุฑุง ูุณุชููุงู ุจู ูุฏู ุจุฏููุ ฺฉุงุฑ ููโฺฉูุฏ!


-ุฑูุดโูุง ุชุจุฏู ูฺฺฏโูุง ุฏุณุชูโุง ุจู ุนุฏุฏ:

     ฑ. Label Encoding (ุฑูุฒฺฏุฐุงุฑ ุจุฑฺุณุจ - ูุฎุตูุต ุฏุชุง ุงูุฑุฏูุงู)
    ฒ. One-Hot Encoding (  ุฑูุฒฺฏุฐุงุฑ ุชฺฉโุฏุงุบ - ูุฎุตูุต ุฏุงุฏู ูุง ูุงููุงู)
     ณ. Ordinal Encoding (ุฑูุฒฺฏุฐุงุฑ ุชุฑุชุจ - ูุฎุตูุต ุงูุฑุฏูุงู ฺฉู ุชุฑุชุจ ุฏุณุช ุฎูุฏุช )
    ด. Target Encoding (ุฑูุฒฺฏุฐุงุฑ ุจุฑ ุงุณุงุณ ููุฏุงุฑ ูุฏู - ูุฎุตูุต ุฏุชุงูุง ุฒุงุฏ ู ูุฏููุง ูพฺุฏู)

"""
# %%
train_features[["ocean_proximity"]].value_counts()
# %%
# ุงู ฺฉุฏ ุณุชูู ocean_proximity ุฑู ุงุฒ train_features ุฌุฏุง ูโฺฉูู ู ฺฉ ุฏุชุงูุฑู ุฌุฏุฏ ุจู ูุงู train_features_categorical ูโุณุงุฒู.
train_features_categorical = train_features[["ocean_proximity"]]
# %% md

# OrdinalEncoder
# %%
from sklearn.preprocessing import OrdinalEncoder

# %%
oe = OrdinalEncoder()
ocean_proximity_index = oe.fit_transform(train_features_categorical)
ocean_proximity_index

# ูฺฉุชู ููู : ุงูุจุชู ุจุงุฏ ุชูุฌู ุฏุงุดุช ฺฉู OrdinalEncoder ุจุฑุง ุฏุงุฏู ูุง ุงู ุณุชูู ฺฉู ุงูุฑุฏูุงู ูุณุชูุฏ ู ูุงููุงู ูุณุชูุฏ ููุงุณุจ ูุณุช
# ฺูู ูพุงุชูู ุจุฑุง ุงุนุฏุงุฏ ุจุฒุฑฺฏุชุฑ ููฺฉูู ุงุฑุฒุด ุฏฺฏุฑ ูุงุฆู ุดูุฏ


# ูฺฉุชู ููู : #  ุฏุฑ ูุงูุน fit_transform ูุช ู ุชุฑูุณููุฑู ุฑุง ุจุง ูู ุงูุฌุงู ูุฏู
# ุญุชูุง ุชูุฌู ุดูุฏ ฺฉู fit_transform ููุท ุจุฑุง ุชุฑู ูุณุชุด
# ู ุจุฑุง ุชุณุช ุญุชูุง ุงูู ุจุงุฏ ูุช ฺฉุฑุฏ ู ุจุนุฏ ุงฺฏุฑ ุฎูุงุณุช ุชุฑูุณููุฑู ฺฉุฑุฏ
# ฺูู ุฏุฑ ุบุฑ ุงูุตูุฑุช ุงูฺฏุงุฑ ุชูุถุญ ุฑุง ุจุฑุง ุชุณุช ูู ุฏุงุฏ ฺฉู ุฏฺฏู ุชุณุช ุจุฑุง ูุฏู ูุงุดูุงุฎุชู ูุณุช

# %%
train_features_categorical
# %%
# ุงูุฌุง ูุดุฎุต ูฺฉูู ฺฉู ุงุนุฏุงุฏ ุฑุง ุจู ุชุฑุชุจ ุจู ฺฉุฏุงู ฺฉ ุงุฒ ุฏุณุชู ูุง ุฏุงุฏู
# ุชูุฌู ุดูุฏ ฺฉู ุงูู ูุดู ุตูุฑ ู ุจู ููู ุชุฑุชุจ ุฌูู ูุฑู
oe.categories_
# %% md
# OneHotEncoder
# %%
from sklearn.preprocessing import OneHotEncoder

# %%
ohe = OneHotEncoder()
ocean_proximity_ohe = ohe.fit_transform(train_features_categorical)

# ุฏุฑ ูุงูุน fit_transform ูุช ู ุชุฑูุณููุฑู ุฑุง ุจุง ูู ุงูุฌุงู ูุฏู
# ุญุชูุง ุชูุฌู ุดูุฏ ฺฉู fit_transform ููุท ุจุฑุง ุชุฑู ูุณุชุด
# ู ุจุฑุง ุชุณุช ุญุชูุง ุงูู ุจุงุฏ ูุช ฺฉุฑุฏ ู ุจุนุฏ ุงฺฏุฑ ุฎูุงุณุช ุชุฑูุณููุฑู ฺฉุฑุฏ
# ฺูู ุฏุฑ ุบุฑ ุงูุตูุฑุช ุงูฺฏุงุฑ ุชูุถุญ ุฑุง ุจุฑุง ุชุณุช ูู ุฏุงุฏ ฺฉู ุฏฺฏู ุชุณุช ุจุฑุง ูุฏู ูุงุดูุงุฎุชู ูุณุช

# %%
ocean_proximity_ohe.toarray()
# %%
ohe.categories_
# %%
# ุงู ูุชุฏ ุงุณู ุณุชูููุง ุฑุง ุจูููู ูุฏู
ohe.get_feature_names_out()
# %%
# ุญุงูุง ุฏฺฏู ุจุง ูุฏู OneHotEncoder ุจู ุฌุง ุงุณุงู ุงุนุฏุงุฏ ุฏุงุฑู
train_features_categorical_ohe = pd.DataFrame(ocean_proximity_ohe.toarray(),
                                              columns=ohe.get_feature_names_out())
# %% md
 #_________________________________________________________________________________________________________________________________________
"""
ุฏุงุฏู ูุง ูพุฑุช:

    ุฏุงุฏูโูุง ุงูุช ูุฑ (Outlier Data) ุจู ุงูฺฏูุณ Outlier Data ุง ุจู ุทูุฑ ุณุงุฏูโุชุฑ Outliers

ูุซุงู:

    ูุซูุง ูุฑุถ ฺฉูุฏ ูุซูุง ู ุชุนุฏุงุฏ ุฒุงุฏ ุฏุงุฏู ุจู 1 ุชุง 100 ุฏุงุฑุฏ
    ู ุจุนุฏ  ฺูุฏ ููุฏุงุฑ ูู ุฏุงุฑุฏ ฺฉู 500
    ุญุงูุง ููุช ูู ูุงฺฉุณ ุงุณฺฉูุฑ ุฑุง ุงูุฌุงู ูุฏู ู ูุซูุง ุจุงุฒู 1 ุชุง -1 ุฏุฑูุธุฑ ฺฏุฑูุชู ู ุชุนุฏุงุฏ ุฒุงุฏ ุงุฒ ุจุงุฒู -1 ุชุง 1 ููุงุฏุฑ ุฒุงุฏ ุฏุงุฏููุฏุงุฑู ูู ุฌุง ุฏฺฏุฑ ุงุฒ ุจุงุฒู ุชุนุฏุงุฏ ุฒุงุฏ ุฏุงุฏู ุฏุงุฑู
"""

# %% md
 #_________________________________________________________________________________________________________________________________________
"""
- ุฏุงุดุชู ุฏุชุง ุงุณฺฉูุฑูุง ุฒุงุฏ ููฺฉู ุงุณุช ุจุงุนุซ ุนููฺฉุฑุฏ ูุงููุงุณุจ ุดูุฏ.
- 
            ูุฑุถ ฺฉูุฏ ุณู ุณุชูู ุฏุฑ ูุฌููุนู ุฏุงุฏู ุดูุง ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ููุงุฏุฑ ุขูโูุง ุฏุฑ ุจุงุฒูโูุง ูุฎุชูู ูุฑุงุฑ ุฏุงุฑูุฏ:

            ุณุชูู A: ููุงุฏุฑ ุจู 0 ุชุง 15
            ุณุชูู B: ููุงุฏุฑ ุจู 20,000 ุชุง 40,000
            ุณุชูู C: ููุงุฏุฑ ุจู 2,000 ุชุง 6,000

            ุงฺฏุฑ ุงุฒ ฺฉ ุงูฺฏูุฑุชู ุงุฏฺฏุฑ ูุงุดู ุงุณุชูุงุฏู ฺฉูุฏ ฺฉู ุจู ูุงุตูู ุง ุงูุฏุงุฒู ุญุณุงุณ ุงุณุช (ูุงููุฏ KNNุ SVMุ ุดุจฺฉูโูุง ุนุตุจ)ุ ุณุชูู B ุจู ุฏูู ุฏุงุดุชู ููุงุฏุฑ ุจุณุงุฑ ุจุฒุฑฺฏโุชุฑุ ุชุงุซุฑ ุจุณุงุฑ ุจุดุชุฑ ุจุฑ ุฑู ูุญุงุณุจุงุช ุฎูุงูุฏ ุฏุงุดุช. ุจู ุนุจุงุฑุช ุฏฺฏุฑุ ุงูฺฏูุฑุชู ุจู ุชุบุฑุงุช ุฏุฑ ุณุชูู B ุงููุช ุจุดุชุฑ ูโุฏูุฏุ ุญุช ุงฺฏุฑ ุชุบุฑุงุช ุฏุฑ ุณุชูู A ุง C ุงุฒ ูุธุฑ ุงููุช ูุงูุน ุฏุฑ ุฏุงุฏูโูุง ุจุดุชุฑ ุจุงุดูุฏ.


- ุฏุชุง ุงุณฺฉูุฑูุง ุงููุงุน ูุฎุชูู ุฏุงุฑูุฏุ ุงุฒ ุฌููู:

        MinMaxScaler: ููุงุฏุฑ ุฑุง ุจู ฺฉ ุจุงุฒู ูุดุฎุต (ูุนูููุงู 0 ุชุง 1) ููุงุณโุจูุฏ ูโฺฉูุฏ.
        StandardScaler: ููุงุฏุฑ ุฑุง ุจู ฺฏูููโุง ุชุบุฑ ูโุฏูุฏ ฺฉู ูุงูฺฏู ุขู ุตูุฑ ู ุงูุญุฑุงู ูุนุงุฑ ุขู ฺฉ ุดูุฏ.
        RobustScaler: ูุณุจุช ุจู ุฏุงุฏูโูุง ูพุฑุช (Outliers) ููุงููโุชุฑ ุงุณุช.
        - 

ุชูุงูุชโูุง ฺฉูุฏ:

    - MinMaxScaler:
        ุฑูุด: ููุงุฏุฑ ุฑุง ุฎุท ุจู ฺฉ ุจุงุฒู ูุดุฎุตุ ูุนูููุงู ุจู 0 ู 1ุ ููุงุณโุจูุฏ ูโฺฉูุฏ.
        ูุฒุงุง: ุญูุธ ุดฺฉู ุชูุฒุน ุฏุงุฏูโูุงุ ูุญุฏูุฏ ฺฉุฑุฏู ููุงุฏุฑ ุจู ฺฉ ุจุงุฒู ูุดุฎุต.
        ูุนุงุจ: ุญุณุงุณุช ุจู ุฏุงุฏูโูุง ูพุฑุช.
        ฺฉุงุฑุจุฑุฏ: ุฒูุงู ฺฉู ูุงุฒ ุจู ูุญุฏูุฏ ฺฉุฑุฏู ุจุงุฒู ููุงุฏุฑ ุงุณุชุ ุง ุฒูุงู ฺฉู ุชูุฒุน ุฏุงุฏูโูุง ููู ุงุณุช ู ุฏุงุฏูโูุง ูพุฑุช ุฒุงุฏ ูุฌูุฏ ูุฏุงุฑูุฏ.

    - StandardScaler:
        ุฑูุด: ููุงุฏุฑ ุฑุง ุจู ฺฏูููโุง ุชุบุฑ ูโุฏูุฏ ฺฉู ูุงูฺฏู ุขู ุตูุฑ ู ุงูุญุฑุงู ูุนุงุฑ ุขู ฺฉ ุดูุฏ.
        ูุฒุงุง: ููุงุณุจ ุจุฑุง ุงูฺฏูุฑุชูโูุง ุญุณุงุณ ุจู ูุงุตููุ ุจูุจูุฏ ููฺฏุฑุง ุจุฑุฎ ุงูฺฏูุฑุชูโูุงุ ฺฉุงูุด ุชุงุซุฑ ุฏุงุฏูโูุง ูพุฑุช (ูุณุจุช ุจู MinMaxScaler).
        ูุนุงุจ: ุญุณุงุณุช ุจู ุฏุงุฏูโูุง ูพุฑุช (ุงฺฏุฑฺู ฺฉูุชุฑ ุงุฒ MinMaxScaler)ุ ุจุงุฒู ููุงุฏุฑ ูุญุฏูุฏ ููโุดูุฏ.
        ฺฉุงุฑุจุฑุฏ: ุฒูุงู ฺฉู ุงูฺฏูุฑุชู ุจู ูุงุตูู ุญุณุงุณ ุงุณุชุ ุฏุงุฏูโูุง ุชูุฑุจุงู ุชูุฒุน ูุฑูุงู ุฏุงุฑูุฏ ู ุฏุงุฏูโูุง ูพุฑุช ุฒุงุฏ ูุฌูุฏ ูุฏุงุฑูุฏ.

    - RobustScaler:
        ุฑูุด: ุงุฒ ูุงูู ู ฺุงุฑฺฉโูุง ุจุฑุง ููุงุณโุจูุฏ ุงุณุชูุงุฏู ูโฺฉูุฏ ู ูุณุจุช ุจู ุฏุงุฏูโูุง ูพุฑุช ููุงููโุชุฑ ุงุณุช.
        ูุฒุงุง: ููุงููุช ุจุงูุง ุฏุฑ ุจุฑุงุจุฑ ุฏุงุฏูโูุง ูพุฑุช.
        ูุนุงุจ: ุจุงุฒู ููุงุฏุฑ ูุญุฏูุฏ ููโุดูุฏุ ููฺฉู ุงุณุช ุจุฑุง ุฏุงุฏูโูุง ุจุฏูู ูพุฑุช ุนููฺฉุฑุฏ ุฎูุจ ูุฏุงุดุชู ุจุงุดุฏ.
        ฺฉุงุฑุจุฑุฏ: ุฒูุงู ฺฉู ูุฌููุนู ุฏุงุฏู ุดุงูู ุชุนุฏุงุฏ ุฒุงุฏ ุฏุงุฏู ูพุฑุช ุงุณุช.

ุงูุชุฎุงุจ ุฑูุด ููุงุณุจ:
ุงูุชุฎุงุจ ุจูุชุฑู ุฑูุด ููุงุณโุจูุฏ ุจุณุชฺฏ ุจู ูฺฺฏโูุง ุฏุงุฏูโูุง ู ููุน ุงูฺฏูุฑุชู ุงุฏฺฏุฑ ูุงุดู ููุฑุฏ ุงุณุชูุงุฏู ุฏุงุฑุฏ.

    ุงฺฏุฑ ุฏุงุฏูโูุง ูพุฑุช ุฒุงุฏ ุฏุงุฑุฏุ RobustScaler ุงูุชุฎุงุจ ููุงุณุจโุชุฑ ุงุณุช.
    ุงฺฏุฑ ุงูฺฏูุฑุชู ุดูุง ุจู ูุงุตูู ุญุณุงุณ ุงุณุช ู ุฏุงุฏูโูุง ูพุฑุช ุฒุงุฏ ูุฏุงุฑุฏุ StandardScaler ููฺฉู ุงุณุช ุจูุชุฑ ุจุงุดุฏ.
    ุงฺฏุฑ ูุงุฒ ุจู ูุญุฏูุฏ ฺฉุฑุฏู ุจุงุฒู ููุงุฏุฑ ุฏุงุฑุฏ ุง ุฏุงุฏูโูุง ูพุฑุช ุฒุงุฏ ูุฏุงุฑูุฏุ MinMaxScaler ูโุชูุงูุฏ ููุงุณุจ ุจุงุดุฏ.


ูฺฉุชู ููู:

        ุฏุฑ ุนููุ ููฺฉู ุงุณุช ูุงุฒู ุจุงุดุฏ ฺูุฏู ุฑูุด ุฑุง ุงูุชุญุงู ฺฉูุฏ ุชุง ุจุจูุฏ ฺฉุฏุงู ฺฉ ุจูุชุฑู ุนููฺฉุฑุฏ ุฑุง ุจุฑุง ูุฏู ุดูุง ุงุฑุงุฆู ูโุฏูุฏ. ููู ุงุณุช ฺฉู ุจู ุงุฏ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุงุณฺฉูุฑ ุจุงุฏ ููุท ุจุฑ ุฑู ุฏุงุฏูโูุง ุขููุฒุด ูุช ุดูุฏ ู
         ุณูพุณ ุงุฒ ููุงู ุงุณฺฉูุฑ ุจุฑุง ุชุจุฏู ุฏุงุฏูโูุง ุชุณุช ุงุณุชูุงุฏู ุดูุฏ ุชุง ุงุฒ ูุดุช ุงุทูุงุนุงุช ุฌููฺฏุฑ ุดูุฏ.

"""
# %% md
 #_________________________________________________________________________________________________________________________________________
"""
# MinMaxScaler 
# Normalization ## in sklearn library
ุจู ุทูุฑ ุฎูุงุตู: ุฏุงุฏู ูุง ุฑุง ุจู ุตูุฑ ู ฺฉ ูุจุฑู
ูุฑูุงูุณุงุฒ ฺฉุฑุฏู ุง ูุฑูุงูุฒุดู ุงูุฌุง ุจู ูุนูุง ุชูุฒุน ูุฑูุงู ูุณุช 

"""

"""
-  ููุงุฑุฏ ููุฏ ุจูุฏู MinMaxScaler:

        ุจูุจูุฏ ุนููฺฉุฑุฏ ุงูฺฏูุฑุชูโูุง ุญุณุงุณ ุจู ููุงุณ: ุจุณุงุฑ ุงุฒ ุงูฺฏูุฑุชูโูุง ุงุฏฺฏุฑ ูุงุดูุ ุจู ูฺู ุขูโูุง ฺฉู ุจุฑ ูพุงู ูุงุตูู (ูุงููุฏ KNNุ SVM ุจุง ฺฉุฑูู RBF) ุง ฺฏุฑุงุฏุงู (ูุงููุฏ ุดุจฺฉูโูุง ุนุตุจ) ฺฉุงุฑ ูโฺฉููุฏุ ุจู ููุงุณ ูฺฺฏโูุง ุญุณุงุณ ูุณุชูุฏ. ุงฺฏุฑ ูฺฺฏโูุง ููุงุณโูุง ูุชูุงูุช ุฏุงุดุชู ุจุงุดูุฏุ ูฺฺฏโูุง ุจุง ููุงุฏุฑ ุจุฒุฑฺฏโุชุฑ ูโุชูุงููุฏ ุชุงุซุฑ ุจุดุชุฑ ุจุฑ ุฑู ูุชุฌู ุงูฺฏูุฑุชู ุจฺฏุฐุงุฑูุฏ ู ุจุงุนุซ ุนููฺฉุฑุฏ ูุงููุงุณุจ ุดููุฏ. MinMaxScaler ุจุง ูุฑูุงูโุณุงุฒ ุฏุงุฏูโูุงุ ุงู ูุดฺฉู ุฑุง ฺฉุงูุด ูโุฏูุฏ.

        ุฌููฺฏุฑ ุงุฒ ุณุฑุฑุฒ ุดุฏู ูุญุงุณุจุงุช: ุฏุฑ ุจุฑุฎ ููุงุฑุฏุ ููุงุฏุฑ ุจุณุงุฑ ุจุฒุฑฺฏ ุฏุฑ ูฺฺฏโูุง ูโุชูุงููุฏ ููุฌุฑ ุจู ุณุฑุฑุฒ ุดุฏู ูุญุงุณุจุงุช ุฏุฑ ุงูฺฏูุฑุชูโูุง ุดููุฏ. MinMaxScaler ุจุง ูุญุฏูุฏ ฺฉุฑุฏู ููุงุฏุฑ ุจู ฺฉ ุจุงุฒู ูุดุฎุตุ ุงุฒ ุงู ูุดฺฉู ุฌููฺฏุฑ ูโฺฉูุฏ.

        ุชุณุฑุน ูุฑุขูุฏ ููฺฏุฑุง: ุจุฑุง ุงูฺฏูุฑุชูโูุง ูุงููุฏ ฺฏุฑุงุฏุงู ูุฒูู ฺฉู ุฏุฑ ุดุจฺฉูโูุง ุนุตุจ ุงุณุชูุงุฏู ูโุดููุฏุ ููุงุณโุจูุฏ ูฺฺฏโูุง ูโุชูุงูุฏ ุจู ุชุณุฑุน ูุฑุขูุฏ ููฺฏุฑุง ู ุฑุณุฏู ุจู ูพุงุณุฎ ุจููู ฺฉูฺฉ ฺฉูุฏ.

        ุชูุณุฑูพุฐุฑ ุจูุชุฑ (ุฏุฑ ุจุฑุฎ ููุงุฑุฏ): ููุช ูฺฺฏโูุง ุฏุฑ ฺฉ ุจุงุฒู ูุดุฎุต (ูุซูุงู 0 ุชุง 1) ูุฑุงุฑ ูโฺฏุฑูุฏุ ููฺฉู ุงุณุช ุชูุณุฑ ุขูโูุง ุขุณุงูโุชุฑ ุดูุฏุ ุจู ุฎุตูุต ุงฺฏุฑ ุจุฎูุงูุฏ ุงููุช ูุณุจ ูฺฺฏโูุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ.


- ูุนุงุจ ุงุณุชูุงุฏู ุงุฒ MinMaxScaler:

        ุญุณุงุณุช ุจู ุฏุงุฏูโูุง ูพุฑุช (Outliers): ุงฺฏุฑ ุฏุงุฏูโูุง ูพุฑุช ุฒุงุฏ ุฏุฑ ูุฌููุนู ุฏุงุฏู ูุฌูุฏ ุฏุงุดุชู ุจุงุดูุฏุ MinMaxScaler ูโุชูุงูุฏ ุชุญุช ุชุฃุซุฑ ุขูโูุง ูุฑุงุฑ ฺฏุฑุฏ ู ุจุงุนุซ ุดูุฏ ฺฉู ุณุงุฑ ุฏุงุฏูโูุง ุฏุฑ ฺฉ ุจุงุฒู ุจุณุงุฑ ฺฉูฺฺฉ ูุดุฑุฏู ุดููุฏ.
        ุนุฏู ูุฏุฑุช ุฏุงุฏูโูุง ฺฏูุดุฏู: MinMaxScaler ุจู ุทูุฑ ูุณุชูู ููโุชูุงูุฏ ุฏุงุฏูโูุง ฺฏูุดุฏู ุฑุง ูุฏุฑุช ฺฉูุฏ ู ูุจู ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุขูุ ุจุงุฏ ุฏุงุฏูโูุง ฺฏูุดุฏู ุฑุง ุจุง ุฑูุดโูุง ููุงุณุจ ูุฏุฑุช ฺฉุฑุฏ.


- ฺฉุงุฑุจุฑุฏูุง MinMaxScaler:

        ูพุดโูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุจุฑุง ุงูฺฏูุฑุชูโูุง ุงุฏฺฏุฑ ูุงุดู: ุงู ุฑุงุฌโุชุฑู ฺฉุงุฑุจุฑุฏ MinMaxScaler ุงุณุช. ูุจู ุงุฒ ุขููุฒุด ูุฏูโูุง ุงุฏฺฏุฑ ูุงุดูุ ุจู ุฎุตูุต ูุฏูโูุง ุญุณุงุณ ุจู ููุงุณุ ุงุฒ MinMaxScaler ุจุฑุง ูุฑูุงูโุณุงุฒ ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ.

        ูพุฑุฏุงุฒุด ุชุตุงูุฑ: ุฏุฑ ูพุฑุฏุงุฒุด ุชุตุงูุฑุ ููุงุฏุฑ ูพฺฉุณูโูุง ูุนูููุงู ุจู 0 ู 255 ูุณุชูุฏ. MinMaxScaler ูโุชูุงูุฏ ุจุฑุง ูุฑูุงูโุณุงุฒ ุงู ููุงุฏุฑ ุจู ุจุงุฒู 0 ุชุง 1 ุงุณุชูุงุฏู ุดูุฏุ ฺฉู ูโุชูุงูุฏ ุจู ุจูุจูุฏ ุนููฺฉุฑุฏ ูุฏูโูุง ุจูุง ฺฉุงููพูุชุฑ ฺฉูฺฉ ฺฉูุฏ.

        ูพุฑุฏุงุฒุด ุณฺฏูุงู: ุฏุฑ ูพุฑุฏุงุฒุด ุณฺฏูุงูุ MinMaxScaler ูโุชูุงูุฏ ุจุฑุง ูุฑูุงูโุณุงุฒ ุฏุงููู ุณฺฏูุงูโูุง ุงุณุชูุงุฏู ุดูุฏ.

        ุชุญูู ุฏุงุฏูโูุง ูุงู: ุฏุฑ ุชุญูู ุฏุงุฏูโูุง ูุงูุ ููฺฉู ุงุณุช ุงุฒ MinMaxScaler ุจุฑุง ูุฑูุงูโุณุงุฒ ููุช ุณูุงู ุง ุณุงุฑ ุดุงุฎุตโูุง ูุงู ุงุณุชูุงุฏู ุดูุฏ ุชุง ุจุชูุงู ุขูโูุง ุฑุง ุจูุชุฑ ููุงุณู ฺฉุฑุฏ ุง ุฏุฑ ูุฏูโูุง ูพุดโุจู ุงุณุชูุงุฏู ฺฉุฑุฏ.

        ูุฑ ุฌุง ฺฉู ูุงุฒ ุจู ูุญุฏูุฏ ฺฉุฑุฏู ููุงุฏุฑ ุจู ฺฉ ุจุงุฒู ูุดุฎุต ุจุงุดุฏ: ุจู ุทูุฑ ฺฉูุ ูุฑ ุฌุง ฺฉู ูุงุฒ ุจุงุดุฏ ููุงุฏุฑ ฺฉ ูฺฺฏ ุฑุง ุจู ฺฉ ุจุงุฒู ูุดุฎุต ูุญุฏูุฏ ฺฉูุฏ (ุจุฏูู ุชุบุฑ ุดฺฉู ุชูุฒุน)ุ MinMaxScaler ูโุชูุงูุฏ ููุฏ ุจุงุดุฏ.

ูุซุงู:

        ุชุตูุฑ ฺฉูุฏ ุฏู ูฺฺฏ ุฏุงุฑุฏ: ุณู (ฺฉู ูุนูููุงู ุจู 0 ุชุง 100 ุงุณุช) ู ุฏุฑุขูุฏ (ฺฉู ูโุชูุงูุฏ ุจุณุงุฑ ุจุฒุฑฺฏ ุจุงุดุฏ). ุงฺฏุฑ ุงุฒ ฺฉ ุงูฺฏูุฑุชู ูุจุชู ุจุฑ ูุงุตูู ุงุณุชูุงุฏู ฺฉูุฏุ ุฏุฑุขูุฏ ุจู ุฏูู ููุงุฏุฑ ุจุฒุฑฺฏโุชุฑุ ุชุงุซุฑ ุจุณุงุฑ ุจุดุชุฑ ูุณุจุช ุจู ุณู ุฎูุงูุฏ ุฏุงุดุช. ุงุณุชูุงุฏู ุงุฒ MinMaxScaler ูุฑ ุฏู ูฺฺฏ ุฑุง ุจู ุจุงุฒู 0 ุชุง 1 ูโุจุฑุฏ ู ุจุงุนุซ ูโุดูุฏ ฺฉู ูุฑ ุฏู ูฺฺฏ ุชุงุซุฑ ูุชูุงุณุจ ุฏุฑ ุงูฺฏูุฑุชู ุฏุงุดุชู ุจุงุดูุฏ.

"""
# %%
from sklearn.preprocessing import MinMaxScaler

# %%
mms = MinMaxScaler(feature_range=(-1, 1))
# %%
mms.fit_transform(train_features_numeric)
# %% md
 #_________________________________________________________________________________________________________________________________________
"""
# StandardScaler
#ฺฉ ุฑูุด ูุฑูุงู ุณุงุฒ ุฏุงุฏู ูุงุณุช ฺฉู
 #ฺฉู ูุงูฺฏู ุฏุงุฏูโูุง ุฑุง ุตูุฑ ู ูุงุฑุงูุณ ุขูโูุง ุฑุง ฺฉ ูโฺฉูุฏ.

z = (x - u) / s
u ูุงูฺฏู 
s ุงูุญุฑุงู ูุนุงุฑ

# Standard Deviation ุงุณุชุงูุฏุงุฑุฏ ุฏูุดู :
      ููุงู ุงูุญุฑุงู ูุนุงุฑ ุงุณุช .
      ฺฉ ูุนุงุฑ ุขูุงุฑ ุงุณุช ฺฉู ูุดุงู ูโุฏูุฏ ุฏุงุฏูโูุง ฺูุฏุฑ ุงุฒ ูุงูฺฏู (mean) ูพุฑุงฺฉูุฏู ุดุฏูโุงูุฏ.


"""
# %% md
"""
-  ุงุณุชุงูุฏุงุฑุฏ ฺฉุฑุฏู ุฏุงุฏู ุนู ุฏุงุฏู ุฑุง ูุจุฑู ุจู ูุงูฺฏู ุตูุฑ ู ุงูุญุฑุงู ุงุณุชุงูุฏุงุฑุฏ ฺฉ
- ุงูุง ุงุณุชุงูุฏุงุฑุฏุณุงุฒ ุดฺฉู ุชูุฒุน ุฏุงุฏูโูุง ุฑุง ุชุบุฑ ููโุฏูุฏ.
 - ุนู ุงฺฏุฑ ุฏุงุฏูโูุง ุงุจุชุฏุง ุชูุฒุน ูุฑูุงู ูุฏุงุดุชู ุจุงุดูุฏุ ุจุนุฏ ุงุฒ ุงุณุชุงูุฏุงุฑุฏุณุงุฒ ูู ูุฑูุงู ูุฎูุงููุฏ ุดุฏ

-  ุงุณุชุงูุฏุงุฑุฏ ุฏูุดู ุจุงูุง ูุดุงู ูโุฏูุฏ ฺฉู ุฏุงุฏูโูุง ุจู ุทูุฑ ฺฉู ุงุฒ ูุงูฺฏู ุฏูุฑ ูุณุชูุฏ ู ูพุฑุงฺฉูุฏฺฏ ุฒุงุฏ ุฏุงุฑูุฏ.
-  ุงุณุชุงูุฏุงุฑุฏ ุฏูุดู ูพุงู ูุดุงู ูโุฏูุฏ ฺฉู ุฏุงุฏูโูุง ุจู ุทูุฑ ฺฉู ูุฒุฏฺฉ ุจู ูุงูฺฏู ูุณุชูุฏ ู ูพุฑุงฺฉูุฏฺฏ ฺฉู ุฏุงุฑูุฏ.



ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉุงูุฑ:

    ููุงุณุจ ุจุฑุง ุงูฺฏูุฑุชูโูุง ุญุณุงุณ ุจู ูุงุตูู: ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉุงูุฑ ุจู ุฎูุจ ุจุฑุง ุงูฺฏูุฑุชูโูุง ฺฉุงุฑ ูโฺฉูุฏ ฺฉู ุจู ูุงุตูู ุจู ููุงุท ุฏุงุฏู ุญุณุงุณ ูุณุชูุฏุ ูุงููุฏ ูุงุดูโูุง ุจุฑุฏุงุฑ ูพุดุชุจุงู (ุงุณ ู ุงู)ุ ุฑฺฏุฑุณูู ูุฌุณุชฺฉ ู ุดุจฺฉูโูุง ุนุตุจ.
    ูุฏุฑุช ุฏุงุฏูโูุง ุจุง ุชูุฒุน ูุฑูุงู: ุงฺฏุฑ ุฏุงุฏูโูุง ุดูุง ุชูุฑุจุงู ุชูุฒุน ูุฑูุงู ุฏุงุดุชู ุจุงุดูุฏุ ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉุงูุฑ ูโุชูุงูุฏ ุจู ุจูุจูุฏ ุนููฺฉุฑุฏ ูุฏู ฺฉูฺฉ ฺฉูุฏ.
    ฺฉุงูุด ุชุงุซุฑ ุฏุงุฏูโูุง ูพุฑุช (ุชุง ุญุฏูุฏ): ุงฺฏุฑฺู ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉุงูุฑ ุจู ุงูุฏุงุฒู RobustScaler ุฏุฑ ุจุฑุงุจุฑ ุฏุงุฏูโูุง ูพุฑุช ููุงูู ูุณุชุ ุงูุง ููฺูุงู ูโุชูุงูุฏ ุชุงุซุฑ ุขูโูุง ุฑุง ฺฉุงูุด ุฏูุฏ.

ูุนุงุจ ุงุณุชูุงุฏู ุงุฒ ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉุงูุฑ:

    ุญุณุงุณุช ุจู ุฏุงุฏูโูุง ูพุฑุช: ุฏุงุฏูโูุง ูพุฑุช ูโุชูุงููุฏ ูุงูฺฏู ู ุงูุญุฑุงู ูุนุงุฑ ุฑุง ุจู ุดุฏุช ุชุญุช ุชุงุซุฑ ูุฑุงุฑ ุฏููุฏ ู ุฏุฑ ูุชุฌูุ ููุงุฏุฑ ููุงุณโุจูุฏ ุดุฏู ูุฒ ุชุญุช ุชุงุซุฑ ูุฑุงุฑ ฺฏุฑูุฏ.
    ุนุฏู ูุญุฏูุฏ ฺฉุฑุฏู ุจุงุฒู ููุงุฏุฑ: ุจุฑุฎูุงู MinMaxScaler ฺฉู ููุงุฏุฑ ุฑุง ุจู ฺฉ ุจุงุฒู ูุดุฎุต ูุญุฏูุฏ ูโฺฉูุฏุ ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉุงูุฑ ุจุงุฒู ููุงุฏุฑ ุฑุง ูุญุฏูุฏ ููโฺฉูุฏ. ุงู ููฺฉู ุงุณุช ุฏุฑ ุจุฑุฎ ููุงุฑุฏ ูุดฺฉูโุณุงุฒ ุจุงุดุฏ.

ฺู ุฒูุงู ุงุฒ ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉุงูุฑ ุงุณุชูุงุฏู ฺฉููุ

    ุฒูุงู ฺฉู ุงูฺฏูุฑุชู ุงุฏฺฏุฑ ูุงุดู ุดูุง ุจู ูุงุตูู ุจู ููุงุท ุฏุงุฏู ุญุณุงุณ ุงุณุช.
    ุฒูุงู ฺฉู ุฏุงุฏูโูุง ุดูุง ุชูุฑุจุงู ุชูุฒุน ูุฑูุงู ุฏุงุฑูุฏ.
    ุฒูุงู ฺฉู ุฏุงุฏูโูุง ูพุฑุช ุฒุงุฏ ุฏุฑ ูุฌููุนู ุฏุงุฏู ูุฌูุฏ ูุฏุงุฑูุฏ ุง ุชุงุซุฑ ุขูโูุง ุฑุง ูโูพุฐุฑุฏ.

# ูฺฉุชู ููู:
        ุงฺฏุฑ ูุฏู ุงุตู ุดูุง ุจูุจูุฏ ุนููฺฉุฑุฏ ุงูฺฏูุฑุชูโูุง ุญุณุงุณ ุจู ููุงุณ ู ุชูุฒุน ุงุณุชุ ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉุงูุฑ ุงุบูุจ ุงูุชุฎุงุจ ุจูุชุฑ ุงุณุชุ ุญุช ุงฺฏุฑ ุฏุงุฏูโูุง ุงุฒ ูุจู ุชูุฒุน ูุฑูุงู ุฏุงุดุชู ุจุงุดูุฏ. ุจุง ุงู ุญุงูุ ุงฺฏุฑ ูุงุฒ ุจู ุญูุธ ุดฺฉู ุชูุฒุน ุฏุงุฑุฏ ุง ุฏุงุฏูโูุง ูพุฑุช ุฒุงุฏ ูุฌูุฏ ุฏุงุฑูุฏุ ููโูฺฉุณ ุงุณฺฉุงูุฑ ููฺฉู ุงุณุช ููุงุณุจโุชุฑ ุจุงุดุฏ. 
"""
# %%
from sklearn.preprocessing import StandardScaler

# %%
ss = StandardScaler()
# %%
ss.fit_transform(train_features_numeric)
# %% md
 #_________________________________________________________________________________________________________________________________________
#  ูฺฏุงุฑุชู ุจุฑุง ุฏุงุฏู ูุง ุจุง ฺููู ุฑุงุณุช ุง ุฏู ุฑุงุณุช
# ุจู ุฌุง ูู ูุงฺฉุณ ุงุณฺฉูุฑ ุง ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉูุฑ

"""
ูฺฏุงุฑุชู ฺฏุฑูุชู ุงุฒ ุฏุงุฏูโูุง ููุดู ุชูุฒุน ุฑุง ูุฑูุงู ููโฺฉูุฏุ ุงูุง ุฏุฑ ุจุณุงุฑ ุงุฒ ููุงุฑุฏ ูโุชูุงูุฏ ุฏุงุฏูโูุง ฺฉู ฺููู ุจู ุฑุงุณุช (right-skewed) ูุณุชูุฏ ุฑุง ุจู ุชูุฒุน ูุฒุฏฺฉโุชุฑ ุจู ูุฑูุงู ุชุจุฏู ฺฉูุฏ.

๐น ฺู ุฒูุงู ูฺฏุงุฑุชู ฺฏุฑูุชู ููุฏ ุงุณุชุ

    โ ุฒูุงู ฺฉู ุฏุงุฏูโูุง ุชูุฒุน ฺููู ุจู ุฑุงุณุช ุฏุงุฑูุฏ (ุนู ููุงุฏุฑ ุจุฒุฑฺฏ ุจุณุงุฑ ุฒุงุฏ ูุณุชูุฏ).
    โ ุฒูุงู ฺฉู ููุฏุงุฑ ูุชุบุฑูุง ุจุงุฒู ุจุฒุฑฺฏ ุฏุงุฑูุฏ ู ูุงุฒู ุงุณุช ุชุฃุซุฑ ููุงุฏุฑ ุจุฒุฑฺฏ ฺฉุงูุด ุงุจุฏ.
    โ ุฒูุงู ฺฉู ุชูุฒุน ุฏุงุฏูโูุง ุฏุงุฑุง ุฏู ุณูฺฏู (heavy-tailed) ุจุงุดุฏ.


๐น ฺู ุฒูุงู ูฺฏุงุฑุชู ฺฏุฑูุชู ฺฉูฺฉ ููโฺฉูุฏุ

    โ ุงฺฏุฑ ุฏุงุฏูโูุง ฺููู ุจู ฺูพ ุจุงุดูุฏ (ฺููู ุจู ุณูุช ููุงุฏุฑ ฺฉูฺฺฉ)ุ ูฺฏุงุฑุชู ฺฏุฑูุชู ูุนูููุงู ฺฉูฺฉ ููโฺฉูุฏ.
    โ ุงฺฏุฑ ุฏุงุฏูโูุง ุชูุฒุน ุฏูุจุฎุด (bimodal) ุง ฺูุฏุจุฎุด (multimodal) ุฏุงุดุชู ุจุงุดูุฏุ ูฺฏุงุฑุชู ููโุชูุงูุฏ ุขู ุฑุง ูุฑูุงู ฺฉูุฏ. (ุนู ููุช ูููุฏุงุฑ ุฑุง ูฺฏุงู ูฺฉูู ุฏู ุง ุจุดุชุฑ ุฒูฺฏููู ูุฌูุฏ ุฏุงุฑุฏ)
    โ ุงฺฏุฑ ุฏุงุฏูโูุง ุฏุงุฑุง ููุงุฏุฑ ููู ุง ุตูุฑ ุจุงุดูุฏุ ูุณุชููุงู ููโุชูุงู ุงุฒ ุชุงุจุน ูฺฏุงุฑุชู ูุนููู ุงุณุชูุงุฏู ฺฉุฑุฏ (ฺูู logโก(x)log(x) ุจุฑุง xโค0xโค0 ุชุนุฑู ูุดุฏู ุงุณุช). ุฏุฑ ุงู ุตูุฑุชุ ูโุชูุงู logโก(x+c)log(x+c) ุฑุง ุจู ฺฉุงุฑ ุจุฑุฏ ฺฉู cc ฺฉ ููุฏุงุฑ ุซุงุจุช ูุซุจุช ุงุณุช.
    ๐น ุฌุงฺฏุฒูโูุง ูฺฏุงุฑุชู ุจุฑุง ูุฑูุงูโุณุงุฒ ุฏุงุฏูโูุง

ุงฺฏุฑ ูฺฏุงุฑุชู ฺฏุฑูุชู ุชูุฒุน ุฑุง ูุฑูุงู ูฺฉูุฏุ ูโุชูุงู ุฑูุดโูุง ุฒุฑ ุฑุง ุงูุชุญุงู ฺฉุฑุฏ:

    โ ุชุจุฏู Box-Cox: ุจุฑุง ุฏุงุฏูโูุง ูุซุจุช ู ฺููู ุจู ุฑุงุณุช ููุงุณุจ ุงุณุช.
    โ ุชุจุฏู Yeo-Johnson: ุจุฑุง ุฏุงุฏูโูุง ุฏุงุฑุง ููุงุฏุฑ ููู ู ุตูุฑ ูู ฺฉุงุฑ ูโฺฉูุฏ.
    โ ุฑุดูโฺฏุฑ (ูุซูุงู xx
    โ ุง x1/3x1/3): ฺฏุงู ูโุชูุงูุฏ ฺููฺฏ ุฑุง ฺฉุงูุด ุฏูุฏ.
"""
# %% md
# ูุฎูุงูู ุฏู ูููุฏุงุฑ ุฑุง ุจุง ู ุจุฏูู ูฺฏุงุฑุชู ุจุจูู
# %%
train_features_numeric["total_rooms"].hist(bins=30)
# %%
train_features_numeric["total_rooms"].apply(np.log).hist(bins=30)
# %% md
 #_________________________________________________________________________________________________________________________________________
"""
# ูุงูุช ููุฏุงู ูุง
 #### ุจุฑุง ูฺุฑูุง ุจุง ุณุชูููุง ฺฉู ูููุฏุงุฑุดูู ุจู ุตูุฑุช ูุงูุช ููุฏุงู ูุณุชูุฏ ฺู ฺฉูู:
ฺฉ ุฑูุด:
     ุงุณุชูุงุฏู ุงุฒ ูพุฏ ฺฉุงุช (ฺฉู ูุชุบุฑ ูพูุณุชู ุฑุง ุจุงุฒู ุจุงุฒู ูฺฉูู)
    ููุท ุญูุงุณุชูู ุจุงุดู ุจุนุฏ ฺฉู ฺฉุชฺฏูุฑ ฺฉุชฺฏูุฑ ุดุฏู ุงููุง ุฑุง ุจู ุนุฏุฏ ุชุจุฏู ฺฉูุฏ 
    ุญุงูุง ุง ุจุงุงุณุชูุงุฏู ุงุฒ ูุงู ูุงุช ุงูฺฉุฏูฺฏ ุง ...

ุฑูุด ุฏฺฏุฑ: 
    ูุฏ ฺฉุงฺฉุณูู ูฺุฑ ุฑุง ุฏุฑ ูุธุฑ ูฺฏุฑู
    ุงูุทูุฑ ู ูฺุฑ ูุณุงุฒู ฺฉู ุฏุฑูุงูุน ูุงุฏ ูุงุตูู ุจูู ููุงุท ุฑุง ุงุฒ ุงู ูุฏ ูุงฺฉุณูู ูุดูู ูุฏู
    ฺฉู ุงุตุทูุงุญุง ุจูุด ุณููุงุฑุช ูฺุฑ ฺฏููุฏ ฺฉู ฺฉ ูุนุงุฑ ู ุณุงุฒู ุจุฑุง ุดุจุงูุช ููุงุท ุงุฒ ูุฏ ูุงฺฉุณูู
    ฺฉู ุงฺฏุฑ ุงุฒ ูุฏ ูุงฺฉุณูู ุฏูุฑ ุดูู ุงูู ุดุจุงูุช ฺฉูุชุฑ ูุดู
    ฺฉ ุชุงุจุน  ฺฉู ููฺู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูุฏู  rbf_kernel ุงุณุช
    ูุฑ ุชุงุจุน ฺฉู ููุท ุจู ูุงุตูู ุจู ููุฏุงุฑ ูุฑูุฏ ู ฺฉ ููุฏุงุฑ ูฺฉุณ ูุงุจุณุชู ุจุงุดู ูุชููู ุงูฺฉุงุฑ ุจุฑุงููู ุงูุฌุงู ุจุฏู

"""

# %% md
 #_________________________________________________________________________________________________________________________________________
# rbf_kernel
# %% md
"""
๐น rbf_kernel
๐ธ ูุงู ฺฉุงูู ุงูฺฏูุณ: Radial Basis Function Kernel
๐ธ ุชุฑุฌูู ูุงุฑุณ: ูุณุชู ุชุงุจุน ูพุงู ุดุนุงุน


๐ธ ฺฉุงุฑุจุฑุฏ: ุชุงุจุน ฺฉู ุจุฑุง ุงูุฏุงุฒูโฺฏุฑ ุดุจุงูุช ุจู ุฏู ููุทู ุฏุฑ ูุถุง ุงุณุชูุงุฏู ูโุดูุฏ ู ุฏุฑ ูุงุดูโูุง ุจุฑุฏุงุฑ ูพุดุชุจุงู (SVM)ุ ุงุฏฺฏุฑ ูุงุดู ู ฺฉุงูุด ุจุนุฏ ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ.
ุฏุฑ ุงุฏฺฏุฑ ูุงุดู ู ุฑุงุถุงุชุ ููุช ูโฺฏูู ฺฉู ุชุงุจุน rbf_kernel ุจุฑุง ุงูุฏุงุฒูโฺฏุฑ ุดุจุงูุช ุจู ุฏู ููุทู ุฏุฑ ูุถุง ุงุณุชูุงุฏู ูโุดูุฏุ ุนู ุงู ุชุงุจุน ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุฏู ุจุฑุฏุงุฑ (ููุทู) ฺูุฏุฑ ุจู ูู ูุฒุฏฺฉ ุง ุดุจู ูุณุชูุฏ.

    ุจู ุทูุฑ ุณุงุฏูโุชุฑ:
    ุงฺฏุฑ ุฏู ููุทู ุฎู ูุฒุฏฺฉ ุจุงุดูุฏุ ููุฏุงุฑ rbf_kernel ุนุฏุฏ ูุฒุฏฺฉ ุจู ฑ ุฎูุงูุฏ ุดุฏ.
    ุงฺฏุฑ ุฏู ููุทู ุฏูุฑ ุงุฒ ูู ุจุงุดูุฏุ ููุฏุงุฑ rbf_kernel ุนุฏุฏ ูุฒุฏฺฉ ุจู ฐ ูโุดูุฏ


๐น ุชุงุจุน RBF ฺุณุชุ

    ูุณุชู ุชุงุจุน ูพุงู ุดุนุงุน (RBF) ฺฉ ุชุงุจุน ุบุฑุฎุท ุงุณุช ฺฉู ูุงุตูู ุจู ุฏู ููุทู ุฑุง ุจู ฺฏูููโุง ุชุจุฏู ูโฺฉูุฏ ฺฉู ููุงุท ูุฒุฏฺฉโุชุฑ ุจู ูู ููุฏุงุฑ ุดุจุงูุช ุจุดุชุฑ ุฏุงุดุชู ุจุงุดูุฏ ู ููุงุท ุฏูุฑุชุฑ ููุฏุงุฑ ุดุจุงูุช ฺฉูุชุฑ. ุงู ุชุงุจุน ูุนูููุงู ุฏุฑ ุงุฏฺฏุฑ ูุงุดู ุจุฑุง ููุดูโุจุฑุฏุงุฑ ุฏุงุฏูโูุง ุจู ฺฉ ูุถุง ุจูุนุฏ ุจุงูุงุชุฑ ุงุณุชูุงุฏู ูโุดูุฏ ุชุง ุงูฺฏููุง ุบุฑุฎุท ุฑุง ุจูุชุฑ ุดูุงุณุง ฺฉูุฏ.
     K(x, y) = exp(-gamma ||x-y||^2)

ุขุง rbf_kernel ุจุนุฏ ุฏุงุฏูโูุง ุฑุง ุงูุฒุงุด ูโุฏูุฏุ

    ููุช ูโฺฏูู ฺฉู "ุงู ุชุงุจุน ุฏุงุฏูโูุง ุฑุง ุจู ฺฉ ูุถุง ุจูุนุฏ ุจุงูุงุชุฑ ูฺฏุงุดุช ูโฺฉูุฏ"ุ ุจู ุงู ูุนู ูุณุช ฺฉู ููุดู ููุท ฺฉ ุจูุนุฏ ุงุถุงูู ูโุดูุฏ. ุจูฺฉู rbf_kernel ุฏุงุฏูโูุง ุฑุง ุงุฒ ูุถุง ุงุตูโุดุงู ุจู ฺฉ ูุถุง ุฌุฏุฏุ ฺฉู ูโุชูุงูุฏ ุฎู ุจูุนุฏ ุจุงุดุฏุ ูฺฏุงุดุช ูโฺฉูุฏ.
    ฺุฑุง ุงู ุงุชูุงู ูโุงูุชุฏุ

    ุจุฑุฎ ูุณุงุฆู ุงุฏฺฏุฑ ูุงุดูุ ูุซู SVMุ ููุช ุฏุงุฏูโูุง ุฑุง ุฏุฑ ูุถุง ุงุตู ุจุฑุฑุณ ูโฺฉููุฏุ ููฺฉู ุงุณุช ุฎุท ุฌุฏุงุดุฏู ูุจุงุดูุฏ (ุนู ูุชูุงู ุจุง ฺฉ ุฎุท ุณุงุฏู ุขูโูุง ุฑุง ุฏุณุชูโุจูุฏ ฺฉุฑุฏ). ุงูุง ุงฺฏุฑ ุฏุงุฏูโูุง ุฑุง ุจู ฺฉ ูุถุง ุจูุนุฏ ุจุงูุงุชุฑ ุจุจุฑูุ ููฺฉู ุงุณุช ุจุชูุงูู ุจุง ฺฉ ูุฑุฒ ุฎุท ุขูโูุง ุฑุง ุฌุฏุง ฺฉูู.

     ูุซุงู ุณุงุฏู:
    ูุฑุถ ฺฉูุฏ ููุงุท ุฒุฑ ุฑุง ุฏุฑ ุตูุญู ุฏูโุจูุนุฏ ุฏุงุฑู:

    ููุทูโูุง ฺฉูุงุณ A: (1, 1) ู (2, 2)
    ููุทูโูุง ฺฉูุงุณ B: (5, 5) ู (6, 6)

    ุงฺฏุฑ ุงู ููุงุท ุฑุง ุฏุฑ ูุถุง ุฏูโุจุนุฏ ุจุจููุ ููฺฉู ุงุณุช ูุชูุงูู ุจูโุฑุงุญุช ฺฉ ุฎุท ุจฺฉุดู ฺฉู ฺฉูุงุณโูุง ุฑุง ุฌุฏุง ฺฉูุฏ. ุงูุง ุงฺฏุฑ ุงุฒ rbf_kernel ุงุณุชูุงุฏู ฺฉููุ ุงู ููุงุท ุจู ฺฉ ูุถุง ุจุง ุงุจุนุงุฏ ุจุงูุงุชุฑ ุชุจุฏู ูโุดููุฏ ฺฉู ุฏุฑ ุขูุฌุง ููฺฉู ุงุณุช ุฎุท ุจุฑุง ุฌุฏุงุณุงุฒ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ.


๐น ุขุง ููุดู ฺฉ ุจุนุฏ ุงุถุงูู ูโุดูุฏุ

    ูู! ุชุนุฏุงุฏ ุงุจุนุงุฏ ุฌุฏุฏ ุจู ุชุนุฏุงุฏ ูฺฺฏโูุง ู ุณุงุฎุชุงุฑ ุฏุงุฏูโูุง ุจุณุชฺฏ ุฏุงุฑุฏ. ุฏุฑ ูุงูุนุ RBF ุฏุงุฏูโูุง ุฑุง ุจู ฺฉ ูุถุง ุจุง ุจโููุงุช ุจูุนุฏ (ูุถุง ููุจุฑุช) ูฺฏุงุดุช ูโฺฉูุฏุ ุงูุง ุฏุฑ ุนูู ุงู ูุถุง ุชุฃุซุฑ ุฑุงุถ ุฏุงุฑุฏ ู ูุฏู ูุงุฒ ูุฏุงุฑุฏ ฺฉู ุจูโุตูุฑุช ุตุฑุญ ุงู ูุถุง ุฑุง ูุญุงุณุจู ฺฉูุฏ.


๐น ฺุฑุง ุงุฒ RBF Kernel ุงุณุชูุงุฏู ูโฺฉููุ

    โ ูุฏูโุณุงุฒ ุฑูุงุจุท ุบุฑุฎุท: ุงฺฏุฑ ุฏุงุฏูโูุง ุจูโุตูุฑุช ุฎุท ุฌุฏุงุดุฏู ูุจุงุดูุฏุ RBF ุจู ุงูุชู ุงูฺฏููุง ูพฺุฏู ฺฉูฺฉ ูโฺฉูุฏ.
    โ ฺฉุงุฑุง ุจุงูุง ุฏุฑ ุจุนุฏ ุจุงูุง: ุจุฑุฎูุงู ุจุฑุฎ ุฑูุดโูุงุ RBF ุฏุฑ ูุถุงูุง ุจุง ุงุจุนุงุฏ ุจุงูุง ุฎูุจ ุนูู ูโฺฉูุฏ.
    โ ููุงูู ุฏุฑ ุจุฑุงุจุฑ ููุฒ: ฺูู ูุงุจุณุชู ุจู ูุงุตูู ุจู ุฏุงุฏูโูุงุณุชุ ููุฒูุง ฺฉูฺฺฉ ุชุฃุซุฑ ุฒุงุฏ ุฑู ุขู ูุฏุงุฑูุฏ.


๐น ฺฉุงุฑุจุฑุฏูุง rbf_kernel ุฏุฑ ุงุฏฺฏุฑ ูุงุดู

    SVM (ูุงุดู ุจุฑุฏุงุฑ ูพุดุชุจุงู): ููุช ุฏุงุฏูโูุง ุฎุท ุฌุฏุงุดุฏู ูุณุชูุฏุ RBF Kernel ุขูโูุง ุฑุง ุจู ูุถุง ุจูุนุฏ ุจุงูุงุชุฑ ูฺฏุงุดุช ูโฺฉูุฏ ุชุง ุฌุฏุงูพุฐุฑ ุดููุฏ.
    Kernels in Clustering ( ๅนถ ุฎูุดูโุจูุฏ ): ุฏุฑ ุฑูุดโูุง ูุซู Spectral Clustering ุงุฒ rbf_kernel ุจุฑุง ูุญุงุณุจู ุดุจุงูุช ุจู ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโุดูุฏ.
    Dimensionality Reduction (ฺฉุงูุด ุจูุนุฏ): ุฏุฑ ุฑูุดโูุง ูุซู Kernel PCA ุงุฒ rbf_kernel ุจุฑุง ุงูุชู ูุถุงูุง ููุงุณุจ ฺฉุงูุด ุจุนุฏ ุงุณุชูุงุฏู ูโุดูุฏ.
"""
# %%
from sklearn.metrics.pairwise import rbf_kernel

# %%
rbf_kernel(train_features_numeric[["housing_median_age"]], [[35]], gamma=0.1)
# ุนุจุงุฑุช  [[35]]: ุงู ุจุฎุดุ ููุฏุงุฑ ุซุงุจุช 35 ุฑุง ุจู ุนููุงู ููุทู ูุฑุฌุน ุชุนู ูโฺฉูุฏ.
# ูุฏู ุงู ุงุณุช ฺฉู ุดุจุงูุช ูุฑ ูุงูฺฏู ุณู ุฎุงูู ุฑุง ุจุง ุณู 35 ุณุงู ูุญุงุณุจู ฺฉูู.

# ุนุจุงุฑุช gamma=0.1: ุงู ุจุฎุดุ ููุฏุงุฑ ฺฏุงูุง ุฑุง 0.1 ุชุนู ูโฺฉูุฏ. ุงู ููุฏุงุฑ ฺฉู ฺฏุงูุง ูุดุงู ูโุฏูุฏ ฺฉู ุชุงุซุฑ ููุงุท ุฏุงุฏู ุจุฑ ุฑู ูุญุงุณุจู ุดุจุงูุชุ ฺฏุณุชุฑุฏูโุชุฑ ุงุณุช. ุนู ุฎุงููโูุง ฺฉู ุญุช ูุงูฺฏู ุณู ูุณุจุชุงู ุฏูุฑ ุงุฒ 35 ุณุงู ุฏุงุฑูุฏุ ุจุงุฒ ูู ุชุงุซุฑ ูุงุจู ุชูุฌู ุจุฑ ุฑู ูุชุฌู ฺฉุฑูู ุฎูุงููุฏ ุฏุงุดุช.

# ูุซุงู ุงุฒ ฺฏุงูุง:
# ูุฑุถ ฺฉูุฏ ูุงูฺฏู ุณู ุฎุงููโูุง ุฏุฑ ุณู ููุทูู ุจู ุชุฑุชุจ 30ุ 35 ู 40 ุณุงู ุจุงุดุฏ.
#
#     ุงฺฏุฑ ฺฏุงูุง 0.1 ุจุงุดุฏุ ุดุจุงูุช ุณูโูุง 30 ู 40 ุณุงู ุจุง 35 ุณุงูุ ูุณุจุชุงู ุจุงูุง ุฎูุงูุฏ ุจูุฏุ ุฒุฑุง ุชุงุซุฑ ููุงุท ุฏูุฑุชุฑ ูุฒ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ.
#     ุงฺฏุฑ ฺฏุงูุง 10 ุจุงุดุฏุ ุดุจุงูุช ุณู 35 ุณุงู ุจุง ุฎูุฏุด ุจุณุงุฑ ุจุงูุง ุฎูุงูุฏ ุจูุฏุ ุงูุง ุดุจุงูุช ุณูโูุง 30 ู 40 ุณุงู ุจุง 35 ุณุงูุ ุจุณุงุฑ ูพุงู ุฎูุงูุฏ ุจูุฏุ ุฒุฑุง ููุท ููุงุท ุจุณุงุฑ ูุฒุฏฺฉ ุจู 35 ุณุงู ุชุงุซุฑ ูุงุจู ุชูุฌู ุฏุงุฑูุฏ.
# %%
fig, ax = plt.subplots()
ax.hist(train_features_numeric["housing_median_age"], bins=30)
# ฺฉ ูุณุชูฺฏุฑุงู(histogram) ุงุฒ ุณุชูู"housing_median_age" ุฏุฑ DataFrame train_features_numeric ุฑุณู ูโฺฉูุฏ.
# bins=30 ุชุนุฏุงุฏ ุณุทูโูุง ูุณุชูฺฏุฑุงู ุฑุง ุชุนู ูโฺฉูุฏ.

# ูุงุฒูู ฺฉู ุจุฑุง rbf_kernel ุง ฺฉู ุฏุฑ ฺฉุฏ ูุจู ููุดุชูุ ูุญูุฑ ุงฺฉุณ ุจุณุงุฒูุ ฺูู rbf_kernelุงูฺฏุงุฑ ูุญูุฑy ุงุณุช
hosing_ages = np.linspace(train_features_numeric["housing_median_age"].min(),
                          train_features_numeric["housing_median_age"].max(),
                          1000).reshape(-1, 1)
# ุนุจุงุฑุช np.linspace() ูุงุฏ 1000 ููุทู ุฑุง ุจู ุทูุฑ ูุณุงู ุจู ุญุฏุงูู ู ุญุฏุงฺฉุซุฑ ููุงุฏุฑ ุณุชูู "housing_median_age" ุงุฌุงุฏ ูโฺฉูุฏ.
# .reshape(-1, 1) ุขุฑุงู ุฑุง ุจู ฺฉ ุขุฑุงู ุฏูุจุนุฏ ุจุง 1000 ุฑุฏู ู 1 ุณุชูู ุชุจุฏู ูโฺฉูุฏ. ุงู ฺฉุงุฑ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ rbf_kernel ุถุฑูุฑ ุงุณุช.

rbf1 = rbf_kernel(hosing_ages, [[35]], gamma=0.1)
# ุงู ุฎุท ฺฉุฑูู RBF ุฑุง ุจู hosing_ages ู ููุฏุงุฑ ุซุงุจุช [[35]] ุจุง ฺฏุงูุง 0.1 ูุญุงุณุจู ูโฺฉูุฏ.

ax2 = ax.twinx()
# ุนู ุงูฺฏุงุฑ ุฏุงุฑู ูุญูุฑ ุงฺฉุณ ุฑุง ุชฺฉุฑุงุฑ ูฺฉูู
# ุนู ูุญูุฑ ูุง ฺฉู ุงุฌุงุฏ ูุดู ุฑู ูุญูุฑ ุงฺฉุณ ูุจู ุงุฌุฑุง ูุดู. ุนู ูุญูุฑ ุงฺฉุณ ุจู ุฏู ุชุงุจุน ax1 , ax2 ูุดุชุฑฺฉ ุงุณุช.

ax2.plot(hosing_ages, rbf1, color="black", lw=2)
# %%
fig, ax = plt.subplots()
ax.hist(train_features_numeric["housing_median_age"], bins=30)
# ฺฉ ูุณุชูฺฏุฑุงู(histogram) ุงุฒ ุณุชูู"housing_median_age" ุฏุฑ DataFrame train_features_numeric ุฑุณู ูโฺฉูุฏ.
# bins=30 ุชุนุฏุงุฏ ุณุทูโูุง ูุณุชูฺฏุฑุงู ุฑุง ุชุนู ูโฺฉูุฏ.

# ูุงุฒูู ฺฉู ุจุฑุง rbf_kernel ุง ฺฉู ุฏุฑ ฺฉุฏ ูุจู ููุดุชูุ ูุญูุฑ ุงฺฉุณ ุจุณุงุฒูุ ฺูู rbf_kernelุงูฺฏุงุฑ ูุญูุฑy ุงุณุช
hosing_ages = np.linspace(train_features_numeric["housing_median_age"].min(),
                          train_features_numeric["housing_median_age"].max(),
                          1000).reshape(-1, 1)
# ุนุจุงุฑุช np.linspace() ูุงุฏ 1000 ููุทู ุฑุง ุจู ุทูุฑ ูุณุงู ุจู ุญุฏุงูู ู ุญุฏุงฺฉุซุฑ ููุงุฏุฑ ุณุชูู "housing_median_age" ุงุฌุงุฏ ูโฺฉูุฏ.
# .reshape(-1, 1) ุขุฑุงู ุฑุง ุจู ฺฉ ุขุฑุงู ุฏูุจุนุฏ ุจุง 1000 ุฑุฏู ู 1 ุณุชูู ุชุจุฏู ูโฺฉูุฏ. ุงู ฺฉุงุฑ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ rbf_kernel ุถุฑูุฑ ุงุณุช.

rbf1 = rbf_kernel(hosing_ages, [[35]], gamma=0.1)
# ุงู ุฎุท ฺฉุฑูู RBF ุฑุง ุจู hosing_ages ู ููุฏุงุฑ ุซุงุจุช [[35]] ุจุง ฺฏุงูุง 0.1 ูุญุงุณุจู ูโฺฉูุฏ.

rbf2 = rbf_kernel(hosing_ages, [[35]], gamma=0.2)

ax2 = ax.twinx()
# ุนู ุงูฺฏุงุฑ ุฏุงุฑู ูุญูุฑ ุงฺฉุณ ุฑุง ุชฺฉุฑุงุฑ ูฺฉูู
# ุนู ูุญูุฑ ูุง ฺฉู ุงุฌุงุฏ ูุดู ุฑู ูุญูุฑ ุงฺฉุณ ูุจู ุงุฌุฑุง ูุดู. ุนู ูุญูุฑ ุงฺฉุณ ุจู ุฏู ุชุงุจุน ax1 , ax2 ูุดุชุฑฺฉ ุงุณุช.

ax2.plot(hosing_ages, rbf1, color="black", lw=2)
ax2.plot(hosing_ages, rbf2, color="black", lw=2, ls="--")
# %% md
 #______________________________________________________________________________________________________
# ุณุงุฎุช ฺฉ ูุฏู ุฑฺฏุฑุณูู
"""
 ุจู ุฏู ุฑูุด 
 ฺฉู ุฑูุด ุฏูู ุฎูุงุตู ุชุฑ ุงุณุช
"""

# %% md
# ุฑูุด 1
# %%
from sklearn.linear_model import LinearRegression

# %%
ss = StandardScaler()
target_values = ss.fit_transform(train_target.to_frame())
# to_frame ุชุจุฏู ูฺฉูู ุจู ุฏุชุง ูุฑู. ุฑูุด ูู ูุณุช ฺฉู ุฏูุจุนุฏ ุจุดู
# ฺูู ุจุฑุง ฺฉุงุฑ ฺฉุฑุฏู ุจุง ุงุจุฒุงุฑูุง preprocessing ฺฉู ฺฉุด ุงุณุชุงูุฏุงุฏ ุงุณฺฉูุฑ ุงุณุช ุฏู ุจุนุฏ ุจุดู
target_values
# %%
model = LinearRegression()
model.fit(train_features_numeric[["median_income"]],
          target_values)
# %%
model.fit(train_features_numeric[["median_income"]],
          train_target.to_frame())
# %%
predictions = model.predict(train_features_numeric[["median_income"]].iloc[:5])

# %%
# ูฺฉุชู ููู : ุจุนุฏ ุงุฒ ุงูฺฉู ุงุฒ ูุฏู ฺฉู ุณุงุฎุชู ุฑุง ูพุฑุฏฺฉุดู ฺฉุฑุฏู ุญุงูุง ุจุงุฏ ุงุฒ ุจู ุตูุฑ ู ฺฉ ุฏุฑ ุจุงุฑู

# ุจุฑุง ุงูฺฉู ููุงุฏุฑ ุฑุง ฺฉู ุจู ุตูุฑ ู ฺฉ  ุชุฑูุณููุฑู ฺฉุฑุฏู ุจูุฏู ุฑุง ุจู ุญุงูุช ุงูู ุจุฑฺฏุฑุฏุงูู ุงุฒ ุงููุฑุช ุชุฑุณูููุฑู ุงุณุชูุงุฏู ูฺฉูู
ss.inverse_transform(predictions)
# %% md
#  ุฑูุด ุฏูู:
"""
ุฏฺฏู ูุงุฒู ูุณุช ุจู ุตูุฑุช ฺฉุฏ ุฌุฏุงฺฏุงูู ุชุฑูุณููุฑู ฺฉูู ู ุจุนุฏ ุงุฒ ูพุฑุฏฺฉุช ุฏูุจุงุฑู ุงููุฑุช ุชุฑูุณููุฑู ฺฉูุฏ
"""
# %%
from sklearn.compose import TransformedTargetRegressor

# %%
model = TransformedTargetRegressor(LinearRegression(),
                                   transformer=StandardScaler())

model.fit(train_features_numeric[["median_income"]],
          target_values)
# %%
model.predict(train_features_numeric[["median_income"]].iloc[:5])
# %% md
 #______________________________________________________________________________________________________
# ุชุฑูุณููุฑูุฑ ฺฉุงุณุชู ุง ุณูุงุฑุด
"""ุณุงุฎุช ุชุฑูุณููุฑูุฑ ุฏูุฎูุงู ุฎูุฏููู
ุชุฑูุณูุฑู ุชุงุจุน ุฑุง ุฑู ุณุชูู ุงุนูุงู ูฺฉูู 
ุจุนุฏุง ุงุฏ ูฺฏุฑู ฺฉู ุชุฑูุณูุฑูุฑ ุฑุง ุทุฑุงุญ ฺฉูู ฺฉู ฺฉ ุณุฑ ูพุงุฑุงูุชุฑ ุฑุง ูุฎูุงุฏ ุงุฏ ุจฺฏุฑู 
"""
# %%
from sklearn.preprocessing import FunctionTransformer

# %%
logarithmic_transformer = FunctionTransformer(np.log, inverse_func=np.exp)
# np.log ุชุงุจุน ุงุณุช
# np.log() ุจู ุทูุฑ ูพุดโูุฑุถ ูฺฏุงุฑุชู ุทุจุน (ุจุง ูพุงู e)
# ุฏุฑ ูพุงุชููุ ุงฺฏุฑ ูโุฎูุงูุฏ ูฺฏุงุฑุชู ุจุง ูพุงู 10 ุฑุง ูุญุงุณุจู ฺฉูุฏุ ุจุงุฏ ุตุฑุงุญุชุงู ุงุฒ np.log10()
# ุงฺฏุฑ ุชุงุจุน ุดูุง ุงููุฑุณ ุฏุงุฑู ุจุนุฏ ุงุฒ ุงุณู ุชุงุจุน ุจุงุฏ ุงููุฑุณ ุฑุง ูุงุฑุฏ ฺฉูุฏ
# "ุงฺฉุณูพููุดุงู" (Exponential) ุจู ุทูุฑ ฺฉู ุจู ูุนูุง "ููุง" ุงุณุช # ุชุงุจุน np.exp ุฏุฑ NumPy ุชุงุจุน ููุง ุจุง ูพุงู e ุฑุง ูุญุงุณุจู ูโฺฉูุฏ.

logarithmic_transformer.transform(train_features_numeric[["population"]])
# %% md
# ูุซุงู ุงุฒ ุณุงุฎุช ฺฉ ุชุฑูุณููุฑูุฑ ุฏฺฏุฑ
"""
# ุงุฑ ุจ ุงู ุฑุง ุณูุงุฑุด ูฺฉูู
# ูุฏู ูุนุฑู kw_args  ฺฉู ุจุฑุง ุฏุงุฏู ูุฑูุฏ ุงุณุชูุงุฏู ูุดู
ุจุดุชุฑ ุจุฑุฑุณ ฺฉูู _ ุณูุงู ุฏุงุฑู
"""
# %%
rbf_transformer = FunctionTransformer(rbf_kernel,
                                      kw_args={"Y": [[35.0]],
                                               "gamma": 0.1})
# %%
rbf_transformer.transform(train_features_numeric[["housing_median_age"]])
# %% md
 #______________________________________________________________________________________________________
# ุชุฑูุณููุฑูุฑ ุณูุงุฑุด ุง ุชูุงุจุน ุงูุงุฏู ุฑู ฺูุฏ ุณุชูู ฺุทูุฑ ฺฉุงุฑ ูฺฉูู
"""
ุณูุงู : ุชูุงุจุน ุณูุงุฑุด ุจุง ุงุฑ ุจ ุงู ูุชููู ูุชูุงูุช ุจุงุดู
"""
# %% md
 #______________________________________________________________________________________________________
# duck typing
# ุณุงฺฉุช ูุฑู ูุญูู ุณุงุฎุช ฺฉูุงุณ ู ฺฺฉ ฺฉุฑุฏู ุงุจุฌฺฉุช ุฑุง ุจุง ุงูพุฑูฺ ุง ุฑูฺฉุฑุฏ duck typing ุงูุฌุงู ูุฏู
# ุงฺฏุฑ ฺุฒ ุดุจู ุงุฑุฏฺฉ ุฑุงู ูุฑู ู ุดุจู ุงุฑุฏฺฉ ฺฉูฺฉ ฺฉูฺฉ ูฺฉูู ูพุณ ุจุงุฏ ุงุฑุฏฺฉ ุจุงุดู
# ูพุณ ุทุจู ุฏุงฺฉ ุชุงูพูฺฏ ุฏุฑูุงูุน ุงุจุฌฺฉุช ุฑู ฺฺฉ ููฺฉูู ูุชุฏ ุฑุง ฺฺฉ ูฺฉูู
"""
#ูพุณ ุทุจู ุฏุงฺฉ ุชุงูพฺฏ ุจุฑุง ุณุงุฎุช ฺฉ ุชุฑูุณูุฑูุ ุจุงุฏ ฺฉูุงุณ ุจููุณ ฺฉู ูุชุฏ ูุชุ ุชุฑูุณูุฑูุ ู ูุช ุชุฑูุณูุฑู ุฑุง ุฏุงุดุชู ุจุงุดู

ุชุฑูุณูุฑู ุชุงุจุน ุฑุง ุฑู ุณุชูู ุงุนูุงู ูฺฉูู 
ุจุนุฏุง ุงุฏ ูฺฏุฑู ฺฉู ุชุฑูุณูุฑูุฑ ุฑุง ุทุฑุงุญ ฺฉูู ฺฉู ฺฉ ุณุฑ ูพุงุฑุงูุชุฑ ุฑุง ูุฎูุงุฏ ุงุฏ ุจฺฏุฑู 
"""
# %% md
"""
ุงฺฏุฑ  ุฏุฑ ุณุงฺฉุช ูุฑู ุงุฒ ฺฉ ุณุฑ ุจุณ ฺฉูุงุณูุง ุงุณุชูุงุฏู ฺฉูู ูุชููู ุจู ูุชุฏูุง ุขู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดู.
ูุซูุง :
TransformerMixin ฺฉูฺฉ ูฺฉูู ฺฉู:
ุงฺฏุฑ ูุช ู ุชุฑูุณูุฑูุฑ ุฑุง ุฏุงุดุชู ุจุงุดู ุจู ูุง ูุช ุชุฑูุณูุฑูุฑ ุฑุง ูุฏู 

ุง ูุซูุง:
BaseEstimator
ุงฺฏุฑ ุงุฒ ุจุณ ุงุณุชูุชูุฑ ุงุณุชูุงุฏู ฺฉูู ุงูููุช ุจูู ฺฏุช ูพุงุฑุงูุฒ ู ุณุช ูพุงุฑุงูุฒ ุฑุง ูุฏู
get_params , set_params
"""
# %% md
 #______________________________________________________________________________________________________
# ุงุณฺฉูุฑ ฺฉุงุณุชูู ุง ุณูุงุฑุด
"""ุณุงุฎุช ุงุณฺฉูุฑ ุฏูุฎูุงู ุฎูุฏููู
"""
# %%
css = CustomStandardScaler()
css.fit_transform(train_features_numeric)
# %%
# ุงุจุฒุงุฑ ููู ุจุฑุง ฺฺฉ ฺฉุฑุฏู ุงูฺฉู ุงุฑุงู ูุงู ุงุนุถุงุด ุงุนุดุงุฑ ุจุงุดู
# ู ุงุจุฒุงุฑ ููู ุฏฺฏุฑ: ฺฺฉ ฺฉุฑุฏู ุงูฺฉู ูุช ุดุฏู ุง ูู
from sklearn.utils.validation import check_array, check_is_fitted

from sklearn.base import BaseEstimator, TransformerMixin


# %%
# ุณูุงู : ุจุดุชุฑ ฺฉุงุฑ ุดูุฏ

# ูุฎูุงูู ูุซูุง ฺฉูุงุณ ุงุณุชุงูุฏุงุฑุฏ ุงุณฺฉูุฑ ุฎูุฏููู ุฑุง ุงุฌุงุฏ ฺฉูู
class CustomStandardScaler(BaseEstimator, TransformerMixin):
    # BaseEstimator ุจุงุนุซ ูุดู ฺฉู ฺฉู ูพุงุฑุงูุชุฑูุง ุฏุงูุงูฺฉ ุฑุง ุฑุงุญุช ุจุชูุงูุฏ ุจฺฏุฑุฏ. ู ุจู ุฑุงุญุช ูุชุฏ ฺฏุช ูพุงุฑุงูุฒ ู ุณุช ูพุงุฑุงูุฒ ุฑู ูุฏู

    def __init__(self, hp=0):
        self.hp = hp

    # ุงุณุชูุชูุฑูุง ุจู ูุชุฏ ูุช ู ุชุฑูุณูุฑู ุงุญุชุงุฌ ุฏุงุฑูุฏ ูพุณ ุฏู ุชุงุจุน ุจุง ุงู ูุงู ูููุณู
    def fit(self, X, y=None):
        # ููุฏุงุฑ ุณูู ู ุงฺฉุณ ู ุงฺฏุฑฺฏ ุฑุง ุญุชูุง ูฺฏุฑุฏ
        # ุงฺฏุฑ ูุฑุงุฑ ุจุงุดุฏ ููุท ุฑู ูฺุฑูุง ฺฉุงุฑ ฺฉูุฏ ู y ุฑุง ููฺฏุฑุฏ ููุฏุงุฑุด ุฑุง ูุงู ูุฑุงุฑ ูุฏู

        X = check_array(X)
        # ฺฺฉ ูฺฉูุฏ ฺฉู ุชูุงู ุงุฑุงู ุงุนุดุงุฑ ุจุงุดูุฏ

        # ุงุณุชุงูุฏุงุฑ ุงุณฺฉูุฑ ุจุฑุง ูุญุงุณุจู ุงุฒ  ูุงูฺฏู ู ุงูุญุฑุงู ุงุณุชุงูุฏุงุฏ ุงุณุชูุงุฏู ูฺฉุฑุฏ
        self.mean_of_X = X.mean(axis=0)
        # ูุงูฺฏู ูุฑุงุฑ ุฑู ุณุทุฑูุง ฺฏุฑูุชู ุดูุฏ ูพุณ ูุญูุฑ ุฑุง ูุณุงู ุตูุฑ ูุฑุงุฑ ูุฏู

        # ุงูุญุฑุงู ุงุณุชุงูุฏุงุฑุฏ ุฏุฑ ุชุงุจุน ุงุณุชุงูุฏุงุฏ ุงุณฺฉูุฑ ูุงุฒ ุจูุฏ
        self.std_of_X = X.std(axis=0)

        # ุงู ูู ุจุงุฏ ุญุชูุง ุจุงุฏ ุฏุฑ ูุชุฏ ูุช ุจุงุดู
        self.n_features_in_ = X.shape[1]
        # ฺฉุงุฑุจุฑุฏุด: ุจุฑุง ุงูฺฉู ฺฺฉ ฺฉูุฏ ุชุนุฏุงุฏ ูฺุฑูุง ฺฉู ุฏุฑ ูุช ูุฏ ุจุง ุงูฺู ฺฉู ุจู ุชุฑูุณูุฑู ูุฏ ฺฉ ุจุงุดู
        # ูฺฉุชู ููู: ฺฉ ุฏุงุฏู ุดุฏู ุชุง ุจู ุชุนุฏุงุฏ ุณุชูููุง ุจุงุดู ุนู ุชุนุฏุงุฏ ูฺุฑูุงุ ูู ุชุนุฏุงุฏ ุณููพู ูุง

        # ุฑุชุฑู ุณูู ูู ุญุชูุง ุจุงุฏ ููุดุชู ุจุดู
        return self

    def transform(self, X):
        # ููุท ุณูู ู ุงฺฉุณ ุฑุง ูฺฏุฑู

        check_is_fitted(self)
        # ุงู ฺฺฉ ูฺฉูู ฺฉู ูุช ุดุฏู ุง ูู

        assert self.n_features_in_ == X.shape[1]
        # ุจุฑุฑุณ ฺฉู ฺฉู ุงฺฏุฑ ุชุนุฏุงุฏ ูฺุฑ ุจุฑุงุจุฑ ูุจูุฏ ุงุฑูุฑ ุจุฏู

        X = X - self.mean_of_X
        return X / self.std_of_X


# %%
css = CustomStandardScaler()
css.fit_transform(train_features_numeric)
# %% md

# %% md
 #______________________________________________________________________________________________________
# pipeline
"""
ุฏุฑ ุงุฏฺฏุฑ ูุงุดูุ "ูพุงูพ ูุงู" (Pipeline) ูุฌููุนูโุง ุงุฒ ูุฑุงุญู ูพุฑุฏุงุฒุด ุฏุงุฏู ุงุณุช ฺฉู ุจู ุชุฑุชุจ ุงุฌุฑุง ูโุดููุฏ. ุงู ูุฑุงุญู ูุนูููุงู ุดุงูู ููุงุฑุฏ ุฒุฑ ูุณุชูุฏ:

    ูพุด ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง: ุงู ูุฑุญูู ุดุงูู ุชูุฒ ฺฉุฑุฏู ุฏุงุฏูโูุงุ ุชุจุฏู ุขููุง ุจู ูุฑูุช ููุงุณุจ ู ุงุณุชุฎุฑุงุฌ ูฺฺฏโูุง ููู ุงุณุช.
    ุขููุฒุด ูุฏู: ุฏุฑ ุงู ูุฑุญููุ ูุฏู ุงุฏฺฏุฑ ูุงุดู ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุงุฏูโูุง ูพุด ูพุฑุฏุงุฒุด ุดุฏู ุขููุฒุด ุฏุงุฏู ูโุดูุฏ.
    ุงุฑุฒุงุจ ูุฏู: ุฏุฑ ุงู ูุฑุญููุ ุนููฺฉุฑุฏ ูุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุงุฏูโูุง ุขุฒูุงุด ุงุฑุฒุงุจ ูโุดูุฏ.
    ุงุณุชูุฑุงุฑ ูุฏู: ุฏุฑ ุงู ูุฑุญููุ ูุฏู ุขููุฒุด ุฏุงุฏู ุดุฏู ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุฏูุง ูุงูุน ูุณุชูุฑ ูโุดูุฏ.

ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ ูพุงูพ ูุงู:

    ุณุงุฏูโุณุงุฒ ูุฑุขูุฏ: ูพุงูพ ูุงูโูุง ูุฑุขูุฏ ูพฺุฏู ุงุฏฺฏุฑ ูุงุดู ุฑุง ุจู ูุฑุงุญู ุณุงุฏูโุชุฑ ู ูุงุจู ูุฏุฑุชโุชุฑ ุชูุณู ูโฺฉููุฏ.
    ุงูุฒุงุด ฺฉุงุฑุง: ูพุงูพ ูุงูโูุง ุจุง ุฎูุฏฺฉุงุฑุณุงุฒ ูุฑุงุญู ูพุฑุฏุงุฒุด ุฏุงุฏูุ ฺฉุงุฑุง ูุฑุขูุฏ ุงุฏฺฏุฑ ูุงุดู ุฑุง ุงูุฒุงุด ูโุฏููุฏ.
    ุฌููฺฏุฑ ุงุฒ ุฎุทุง: ูพุงูพ ูุงูโูุง ุจุง ุชุนุฑู ูุฑุงุญู ูุดุฎุต ู ูุงุจู ุชฺฉุฑุงุฑุ ุงุฒ ุจุฑูุฒ ุฎุทุง ุฏุฑ ูุฑุขูุฏ ุงุฏฺฏุฑ ูุงุดู ุฌููฺฏุฑ ูโฺฉููุฏ.
    ูุงุจูุช ุงุณุชูุงุฏู ูุฌุฏุฏ: ูพุงูพ ูุงูโูุง ุฑุง ูโุชูุงู ุจุฑุง ูพุฑูฺูโูุง ูุฎุชูู ุงุฏฺฏุฑ ูุงุดู ุงุณุชูุงุฏู ฺฉุฑุฏ
"""
# %%
from sklearn.pipeline import Pipeline, make_pipeline

# %%
# ุฑูุด 1:
numerical_features_pipeline = Pipeline([
    ("medianImputer", SimpleImputer(strategy="median")),
    ("minMaxScaler", MinMaxScaler())
])
# "medianImputer" ูุซูุง ุจุฑุง ุชุฑูุณูุฑูุฑ ุงุณู ุชุนู ฺฉุฑุฏู
# ูุฑ ฺุฒ ุบุฑ ุงุฒ ุขุฎุฑ ุจุงุฏ ูุชุฏ ูุช ุชุฑูุณูุฑู ุฑุง ุฏุงุดุชู ุจุงุดู ุจู ุฌุฒ ุขุฎุฑ
# ุจุฑุง ููู ุงุฎุฑ ูุชููู ูุฏู ุงุฏฺฏุฑ ูุงุดูุชูู ุจุงุดู
# %%
# ุฑูุด 2:
make_pipeline(
    SimpleImputer(strategy="median"),
    MinMaxScaler()
)

# ุงู ุฑูุด ุฏฺฏู ูุงุฒู ุจู ุงุณู ฺฏุฐุงุฑ ูุณุช
# %%
numerical_features_pipeline.fit_transform(train_features_numeric)
# %% md
 #______________________________________________________________________________________________________
# ColumnTransformer
"""
ColumnTransformer ฺฉ ุงุจุฒุงุฑ ูพุดโูพุฑุฏุงุฒุด ุงุณุช ฺฉู ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ุชุจุฏูุงุช ูุฎุชูู ุฑุง ุจู ุณุชููโูุง ูุฎุชูู ุฏุงุฏูโูุง ุงุนูุงู ฺฉูุฏ.

ุชุตูุฑ ฺฉูุฏ ฺฉ ุฌุฏูู ุฏุงุฏู ุฏุงุฑุฏ ฺฉู ุดุงูู ุณุชููโูุง ุจุง ุงููุงุน ูุฎุชูู ุฏุงุฏูโูุง ุงุณุช (ูุซูุงู ุงุนุฏุงุฏุ ูุชูุ ุฏุณุชูโุจูุฏ). ูุจู ุงุฒ ุงูฺฉู ุจุชูุงูุฏ ุงู ุฏุงุฏูโูุง ุฑุง ุจู ฺฉ ูุฏู ุงุฏฺฏุฑ ูุงุดู ูุงุฑุฏ ฺฉูุฏุ ุจุงุฏ ุขููุง ุฑุง ุจู ูุฑูุช ุชุจุฏู ฺฉูุฏ ฺฉู ูุฏู ุจุชูุงูุฏ ุขู ุฑุง ุฏุฑฺฉ ฺฉูุฏ.

ColumnTransformer ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ุชุง ุงู ฺฉุงุฑ ุฑุง ุจู ุตูุฑุช ุณุงุฒูุงูุฏู ุดุฏู ู ฺฉุงุฑุขูุฏ ุงูุฌุงู ุฏูุฏ. ุจู ุทูุฑ ุฎุงุต:

    ุชุจุฏูุงุช ุฌุฏุงฺฏุงูู: ูโุชูุงูุฏ ูุดุฎุต ฺฉูุฏ ฺฉู ูุฑ ุณุชูู ุจุงุฏ ุจุง ฺู ููุน ุชุจุฏู ูพุฑุฏุงุฒุด ุดูุฏ. ุจุฑุง ูุซุงูุ ูโุชูุงูุฏ ุณุชููโูุง ุนุฏุฏ ุฑุง ุจุง StandardScaler ููุงุณโุจูุฏ ฺฉูุฏ ู ุณุชููโูุง ูุชู ุฑุง ุจุง OneHotEncoder ุชุจุฏู ฺฉูุฏ.
    ูุฏุฑุช ุณุชููโูุง ูุงููฺฏู: ุจู ุฌุง ููุดุชู ฺฉุฏ ูพฺุฏู ุจุฑุง ูุฏุฑุช ูุฑ ุณุชูู ุจู ุตูุฑุช ุฌุฏุงฺฏุงููุ ูโุชูุงูุฏ ุงุฒ ColumnTransformer ุจุฑุง ุชุนุฑู ุชุจุฏูุงุช ุจู ุตูุฑุช ฺฉุฌุง ุงุณุชูุงุฏู ฺฉูุฏ.


ูุญูู ุนููฺฉุฑุฏ:

ColumnTransformer ูุณุช ุงุฒ ุชุงูพูโูุง ุฑุง ูโฺฏุฑุฏ ฺฉู ูุฑ ุชุงูพู ุดุงูู ููุงุฑุฏ ุฒุฑ ุงุณุช:

    ูุงู ุชุจุฏู: ฺฉ ูุงู ุฏูุฎูุงู ุจุฑุง ุชุจุฏู.
    ุชุจุฏู: ฺฉ ุดุก ุชุจุฏู scikit-learn (ูุงููุฏ StandardScalerุ OneHotEncoderุ ุง ฺฉ ุชุจุฏู ุณูุงุฑุด).
    ุณุชููโูุง: ูุณุช ุงุฒ ูุงู ุณุชููโูุง ุง ุดุงุฎุตโูุง ฺฉู ุชุจุฏู ุจุงุฏ ุฑู ุขููุง ุงุนูุงู ุดูุฏ.

    ูฺฉุชู ููู: ุงฺฏุฑ ุจุฎูุงูู  ุณุชูู ุฑุง ูุงูุฑู ุจู ุฌุง ุชุจุฏู ููุท ูููุณู:
    drop
    ุงฺฏุฑฺู ููุช ูุงู ุณุชูู ุฑุง ุฏุฑ ุฏุงุฎู ฺฉุงููู ุชุฑูุณูุฑูุฑ ูุงูุฑู ุญุฐู ูุดู ฺฏู ุฏุฑุงูพ ฺฉุฑุฏู.


    ูฺฉุชู ููู: ุงฺฏุฑ ุจุฎูุงูู  ุนูู ุฑุง ุณุชูู ุงูุฌุงู ูุฏูู ุจู ุฌุง ุชุจุฏู ููุท ูููุณู:
    passthrough


ููฺฏุงู ฺฉู ColumnTransformer ุงุนูุงู ูโุดูุฏุ ูุฑ ุชุจุฏู ุจู ุณุชููโูุง ูุดุฎุต ุดุฏู ุงุนูุงู ูโุดูุฏ ู ูุชุงุฌ ุจู ูู ูุชุตู ูโุดููุฏ ุชุง ฺฉ ุขุฑุงู ุง DataFrame ุฌุฏุฏ ุงุฌุงุฏ ุดูุฏ.

"""
# %%
from sklearn.compose import ColumnTransformer

# %%
train_features.columns
# %%
numerical_features = list(train_features.columns)
numerical_features.remove("ocean_proximity")
numerical_features
# %%
categorical_features = ["ocean_proximity"]
# %%
numerical_features_pipeline = Pipeline([
    ("medianImputer", SimpleImputer(strategy="median")),
    ("minMaxScaler", MinMaxScaler())
])
# %%
categorical_features_pipeline = Pipeline([
    ("mfImputer", SimpleImputer(strategy="most_frequent")),
    ("ohe", OneHotEncoder())
])
# %%
total_transformation = ColumnTransformer([
    ("numerical", numerical_features_pipeline, numerical_features),
    ("categorical", categorical_features_pipeline, categorical_features)
])
#  ฺฉุงุฑ ฺฉู ุฏุฑ ุจุงูุง ุงูุฌุงู ุดุฏ ูพุงูพ ูุงู ูุง ุฑุง ุฏุงุฎู ฺฉุงููู ุชุฑูุณูุฑูุฑ ุฑุง ูุฑุงุฑ ุฏุงุฏ

# %% md
 #______________________________________________________________________________________________________
# %% md

# %%
total_transformation.fit_transform(train_features)
# %%
total_transformation.get_feature_names_out()
# %% md
 #______________________________________________________________________________________________________
# all of the transformations
"""ฺฉ ุฌูุน ุจูุฏ ุงุฒ ุงุจุชุฏุง ููู ูุงู ุชุง ุจู ุงูุฌุง
"""
# %%
####  ุงูู. ุฑู ููููู ุฎูุฏูุงู ุฑู ุณุชูู ูุฏู ุงูฺฉุงู ุทุจูู ุจูุฏ ุงูุฌุงู ุฏูู
df["median_income_categories"] = pd.cut(df["median_income"],
                                        bins=[0.0, 1.5, 3.0, 4.5, 6.0, np.inf],
                                        labels=[1, 2, 3, 4, 5])

# ุจ. ุฌุฏุง ฺฉุฑุฏู ุชุณุช ู ุชุฑู ุฏุฑ ููููู  ุฑุง ุทุจู ฺฉุชฺฏูุฑ ุง ฺฉู ุงุฌุงุฏ ฺฉุฑุฏู ุงูุฌุงู ูุฏูู
str_train_set, str_test_set = train_test_split(df,
                                               test_size=0.2,
                                               stratify=df["median_income_categories"],
                                               random_state=40)

# ุฌ. ุญุฐู ุณุชูู ฺฉู ุจุฑุง ุทุจูู ุจูุฏ ุงุฌุงุฏ ฺฉุฑุฏู ุจูุฏู
str_train_set = str_train_set.drop("median_income_categories", axis=1)
# axis=1 ุนู ุณุชูู ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑ
str_test_set = str_test_set.drop("median_income_categories", axis=1)
# %%
train_data, test_data = train_test_split(df,
                                         test_size=0.2,
                                         stratify=df["median_income_categories"],
                                         random_state=40)
# %%
train_data = train_data.drop(columns="median_income_categories")
test_data = test_data.drop(columns="median_income_categories")
# %%
train_features = train_data.drop(columns="median_house_value")
train_target = train_data["median_house_value"]

test_features = test_data.drop(columns="median_house_value")
test_target = test_data["median_house_value"]
# %%
# train_features
# %%
heavy_tail_pipeline = make_pipeline(
    SimpleImputer(strategy="median"),
    FunctionTransformer(np.log, feature_names_out="one-to-one"),
    StandardScaler()
)

# ูุชุฌู: ฺฉ ูพุงูพ ูุงู ุจุฑุง ูู ุชู ูุง ุฏุฑ ูุธุฑ ูฺฏุฑู
# %%
categorical_features_pipeline = Pipeline([
    ("mfImputer", SimpleImputer(strategy="most_frequent")),
    ("ohe", OneHotEncoder())
])
# ูุชุฌู: ู ูพุงูพ ูุงู ุจุฑุง ุณุชูู ุบุฑ ุนุฏุฏ
# %%
housing_median_age_rbf_transformer = FunctionTransformer(rbf_kernel,
                                                         feature_names_out="one-to-one",
                                                         kw_args={"Y": [[35.0]], "gamma": 0.1})
# %%
default_numerical_pipeline = make_pipeline(
    SimpleImputer(strategy="median"),
    StandardScaler()
)


# ูุชุฌู: ุจุฑุง ุฏูุงูุช ุฑูุงูุฏุฑ ฺฉุงููู ุชุฑูุณููุฑูุฑ ูุณุช. ุนู ุงฺฏุฑ ุณุชูู ุฑุง ุฏุฑ ฺฉุงููู ุชุฑูุณููุฑูุฑ ูุฏุงุฑู ุญุฐูุดูู ูฺฉูู ู ุนููุงุช ุจุงูุง ุฑุง ูุฑุงุฑ ุจุฏู
# %%
# ูุฏู: ุงู ุชุงุจุน ุจุฑุง ูุญุงุณุจู ูุณุจุช ุจู ููุงุฏุฑ ุณุชูู ุงูู ู ุณุชูู ุฏูู ฺฉ ุขุฑุงู NumPy ุทุฑุงุญ ุดุฏู ุงุณุช.
def ratio_of_columns(X):
    return X[:, [0]] / X[:, [1]]
    # ููู ุณุทุฑูุง ู ุณุชูู ุตูุฑ ุฑุง ุชูุณู ฺฉูุฏ ุจุฑ ููู ุณุทุฑูุง ุงุฒ ุณุชูู ฺฉ
    # ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู [0] ุฏุฑ ุฏุงุฎู ุจุฑุงฺฉุชโูุง ุฏฺฏุฑ ูุฑุงุฑ ุฏุงุฏู ุดุฏู ุงุณุชุ ฺฉู ุจุงุนุซ ูโุดูุฏ ูุชุฌู ฺฉ ุขุฑุงู ุฏู ุจุนุฏ ุจุงุดุฏ.


# ูุฏู: ุงู ุชุงุจุน ุจุฑุง ุชุนู ูุงู ุณุชูู ุฎุฑูุฌ FunctionTransformer ุทุฑุงุญ ุดุฏู ุงุณุช.
def ratio_of_columns_name(function_transformer, feature_names_in):
    return ["ratio"]
    # function_transformer: ุงู ูพุงุฑุงูุชุฑ ฺฉ ุดุก FunctionTransformer ุงุณุช
    # feature_names_in: ุงู ูพุงุฑุงูุชุฑ ูุงู ุณุชูู ูุง ูุฑูุฏ ุงุณุช.
    # return ["ratio"]: ุงู ูุณูุช ุงุฒ ฺฉุฏ ฺฉ ูุณุช ุญุงู ฺฉ ุฑุดุชู ("ratio") ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ. ุงู ุฑุดุชู ุจู ุนููุงู ูุงู ุณุชูู ุฎุฑูุฌ FunctionTransformer ุงุณุชูุงุฏู ูโุดูุฏ.
    # ูุชุฌู: ุงู ุชุงุจุน ููุดู ูุณุช ["ratio"] ุฑุง ุจุฑูฺฏุฑุฏุงูุฏ.


def ratio_of_columns_pipeline():
    return make_pipeline(
        SimpleImputer(strategy="median"),
        # ุงู ูุฑุญูู ููุงุฏุฑ ฺฏูุดุฏู ุฑุง ุฏุฑ ุฏุงุฏูโูุง ุจุง ูุงูู ุณุชูู ูุฑุจูุทู ูพุฑ ูโฺฉูุฏ.

        FunctionTransformer(ratio_of_columns,
                            feature_names_out=ratio_of_columns_name),
        # ratio_of_columns_name ุจุฑุง ุชุนู ูุงู ุณุชูู ุฎุฑูุฌ ุงุณุชูุงุฏู ูโฺฉูุฏ
        StandardScaler()
        # ุงู ูุฑุญูู ุฏุงุฏูโูุง ุฑุง ุจู ฺฏูููโุง ููุงุณโุจูุฏ ูโฺฉูุฏ ฺฉู ูุงูฺฏู ุขููุง ุตูุฑ ู ุงูุญุฑุงู ูุนุงุฑ ุขููุง ฺฉ ุดูุฏ.

    )


# ูุชุฌู: ู ูพุงูพ ูุงู ุจุฑุง ุณุชูููุง ฺฉู ุจุฑ ูู ุชูุณู ูุดู ุฏุฑุณุช ฺฉุฑุฏู
# %%
all_transformations = ColumnTransformer([
    ("bedrooms", ratio_of_columns_pipeline(), ["total_bedrooms", "total_rooms"]),
    ("rooms_per_house", ratio_of_columns_pipeline(), ["total_rooms", "households"]),
    ("people_per_house", ratio_of_columns_pipeline(), ["population", "households"]),
    ("log", heavy_tail_pipeline, ["total_bedrooms", "total_rooms",
                                  "population", "households", "median_income"]),
    ("rbf", housing_median_age_rbf_transformer, ["housing_median_age"]),
    ("cat", categorical_features_pipeline, ["ocean_proximity"])

],
    remainder=default_numerical_pipeline, force_int_remainder_cols=False)
# ุฏุฑ ูุณุฎูโูุง ูุนู scikit-learnุ ุณุชููโูุง ุจุงูโูุงูุฏู ุจู ุนููุงู ุดุงุฎุตโูุง ุนุฏุฏ (int) ุฐุฎุฑู ูโุดููุฏ.
# ุฏุฑ ูุณุฎูโูุง ุขูุฏูุ ุงู ุณุชููโูุง ุจู ุนููุงู ูุงู ุณุชููโูุง (str) ุฐุฎุฑู ุฎูุงููุฏ ุดุฏ.
# ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงู ุงุฎุทุงุฑ ู ุงุณุชูุงุฏู ุงุฒ ุฑูุชุงุฑ ุฌุฏุฏุ
# ูโุชูุงูุฏ ููฺฏุงู ุงุฌุงุฏ ColumnTransformerุ ูพุงุฑุงูุชุฑ force_int_remainder_cols ุฑุง ุจู False ุชูุธู ฺฉูุฏ.

# ูุฑูุฏ ูุง ฺฉุงููู ุชุฑูุณูุฑู ุง ุจูุฏ ฺฉู ุชุฑูุณูุฑู ูุง ุฑุง ูุงุฑุฏ ฺฉูู ู ฺฉ ุฑูุงูุฏุฑ
# ฺฉู ุฑูุงูุฏุฑ ุนู ุงฺฏุฑ ุชุฑูุณูุฑูุฑ ุจุฑุง ุณุชูู ูุฏุงุฏ ุจู ุทูุฑ ูพุดูุฑุถ ุงู ุณุชูู ุญุฐู ูุดู ูู ูุง ุฏุฑ ุงูุฌุง ูุดุฎุต ฺฉุฑุฏู ฺฉู ฺฺฉุงุฑ ฺฉูู
# %%
train_features_transformed = all_transformations.fit_transform(train_features)
# ุฏุฑุณุชู ฺฉู ุงู ฺฉุงููู ุชุฑูุณูุฑู ุงุฒ ูุง ููุท ุชุฑู ูฺุฑ ุฑุง ูุฎูุงุฏ
# ุงูุง ุฒูุงู ฺฉู ูุฏู ุฑุง ุฑู ุงู ฺฉุงููู ุชุฑูุณูุฑูุฑ ูุช ูฺฉูู ุชุฑู ุชุงุฑฺฏุช ุฑุง ูู ูุฎูุงุฏ
# %%
train_features_transformed.shape
# %%
all_transformations.get_feature_names_out()
# %%
train_features_transformed
# %% md

# %% md
 #______________________________________________________________________________________________________
# ุดุฑูุน ูุฏููุง ุงุฏฺฏุฑ ูุงุดู
# %% md
 #______________________________________________________________________________________________________
# LinearRegression
# %%
from sklearn.linear_model import LinearRegression

# %%
linear_regression_pipeline = make_pipeline(all_transformations,
                                           LinearRegression())
# ุฏุฑ ูพุงูพ ูุงู ฺฉู ุฏุฑุณุช ูฺฉูู ุงุณู ูุฏู ุจุงุฏ ุงุฎุฑ ููุดุชู ุดูุฏ ฺูู ูุฎูุงูู ุฑูุดุด ูพุฑุฏฺฉุดู ุฏุงุดุชู ุจุงุดู
# %%


linear_regression_pipeline.fit(train_features,
                               train_target)
# ูุฏู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ fit ุขููุฒุด ุฏุงุฏู.

# ุฏุฑุณุชู ฺฉู ุงู ูพุงูพ ูุงู ุงุฒ ูุง ููุท ุชุฑู ูฺุฑ ุฑุง ูุฎูุงุณุช
# ุงูุง ุฒูุงู ฺฉู ูุฎูุงูู ูุฏู ุฑุง ุฑู ุงู ฺฉุงููู ุชุฑูุณูุฑูุฑ ูุช ฺฉูู ุชุฑู ุชุงุฑฺฏุช ุฑุง ูู ูุฎูุงุฏ
# %%
house_value_prediction = linear_regression_pipeline.predict(train_features)
# %%
house_value_prediction
# ููุงุฏุฑ ฺฉู ูุฏู ูพุด ุจู ฺฉุฑุฏู
# %%
train_target.values
# ุงุตู ููุงุฏุฑ ฺฉู ุจูุฏู
# %% md
# ุงุฑุฒุงุจ ูุฏู ุฑฺฏุฑุณูู
# %%
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score

# %%
# mean_squared_error(train_target.values, house_value_prediction,
#                    squared=False)
# ุณูุงู : ุจุฑุง ูู ุจุง ูุฌูุฏ ฺฉู ูุณุฎู ุณุงฺฉุช ูุฑู 1.6.1 ุจูุฏ ุฎุทุง ูุฏุงุฏ
# %%
mean_absolute_error(train_target.values, house_value_prediction)
# %%
r2_score(train_target.values, house_value_prediction)
# %% md
# DecisionTree
ุฏุฑุฎุช
ุชุตูู
# %%
from sklearn.tree import DecisionTreeRegressor

# %%
dt_regression_pipeline = make_pipeline(all_transformations,
                                       DecisionTreeRegressor())
# %%
dt_regression_pipeline.fit(train_features,
                           train_target)
# %%
mean_absolute_error(train_target.values,
                    dt_regression_pipeline.predict(train_features))

# ุฌูุงุจ ฺฉู ูุฏู ุงููุฏ ุฏูู ฺฉู ูฺฏูู ุงูุฑูุช ุดุฏู ู ูุฏู ุจุณุงุฑ ูพฺุฏู ุงุณุช
# ูุฏู ูุจู ูู ฺฉู ุฑฺฏุฑุณูู ุจูุฏ ูู ุงููุฏ ุฎุทุง ุฒุงุฏ ุจูุฏ ฺฉู ูููุฏู ุขูุฏุฑ ูุช ุงุณุช ู ุฒูุฑุด ููุฑุณุฏ
# %%
r2_score(train_target.values,
         dt_regression_pipeline.predict(train_features))
# %% md
 #______________________________________________________________________________________________________
# Cross Validation
# ููุฏูุดู
#### ุจุฎุด ุฑุง ุงุฒ ุฏุงุฏูุง ุชุฑู ุฑุง ุจู ุนููุงู ููุฏุดู ุฌุฏุง ูฺฉูู ฺฉู ุงูุจุชู ุฌุฏุง ุฏุงุฏู ูุง ุชุณุช ูุณุชุด
##### ุจุฑุง ุจุฑุฑุณ ู ุชุณุชุ ูุจู ุงุฒ ุชุณุช ุงุตู ูุณุชุด
# %%
from sklearn.model_selection import cross_val_score

# %%
dt_mae = -cross_val_score(dt_regression_pipeline,
                          train_features,
                          train_target,
                          scoring="neg_mean_absolute_error",
                          cv=5)
# ุงููู ุนุถูุด ูุฏู ุฑุง ูฺฏุฐุงุฑู
# ุฏููู ุนุถูุด ุงฺฉุณ ู ุจุนุฏุด ูุง ุฑุง ูุงุฑุฏ ูฺฉูู
# scoring ุนู ุจุง ฺู ูุนุงุฑ ฺฉุงุฑ ฺฉู.
# ุณ ู cv ุนู ุจู ุชุนุฏุงุฏ ุจุงุฑ ฺฉู ุชุนู ูฺฉู ฺฉู ุฏุงุฏู ุฑุง ูุซูุง 5 ูุณูุช ูุณุงู ูฺฉูุฏ ู ู ฺฉ ูพูุฌู ุฑุง ุจู ุนููุงู ููุฏุดู ุจุฑูุฏุงุฑู

dt_mae
# ฺฉู 5 ุชุง ูุฏู ุจูููู ูุฏู
# %%
pd.DataFrame(dt_mae).describe()
# %% md

# GridSearchCV
#### ุจูุชุฑ ุงุณุช ฺฉุฑุงุณ ููุฏุดู ูุจู ุงุณุช
# %%
from sklearn.model_selection import GridSearchCV

# ฺฉู ูพุงุฑุงูุชุฑ ุงูู ูุชููู ูุฏู ุง ูพุงูพ ูุงูููู ุจุงุดู
# ูพุงุฑุงูุชุฑ ุฏูู ูพุงุฑุงู ฺฏุฑุฏ ูุณุช ุนู ูุถุง ฺฉู ูุฑุงุฑ ุงุณุช ุฏุงุฎูุด ุฌุณุชุฌู ุฑุง ุงูุฌุงู ุฏูุฏ ุฑุง ูุฎูุงุฏ
# ูพุงุฑุงูุชุฑ ุจุนุฏ ุงุณฺฉูุฑูฺฏ
# ุณ ู ูู ุฏุงุฑู ุนู ฺฉุฑุงุณ ููุฏุดู ูู ูุฏู ุฏุฑ ุงุฎุฑ ุจูุชุฑู ุฑุง ูุฏู
# %% md
# method1
# ุฑูุด ุงูู
# %%

# %%
param_grid = {"max_depth": [5, 10, 15]}
# ุจูุชุฑู ุจู ุตูุฑุช ุฏุดฺฉูุฑ ููุดุชู ุดูุฏ
# %%
gs = GridSearchCV(DecisionTreeRegressor(),
                  param_grid,
                  scoring="neg_mean_absolute_error",
                  cv=5)

# ุฏุงุฎู ูพุฑุงูุชุฒ ูุฏู ุงฺฏุฑ ูพุงุฑุงูุชุฑ ุฑุง ุจฺฏุฐุงุฑู ุนู ูุฎูุงูู ุงูู ูพุงุฑุงุชุฑ ุซุงุจุช ุจุงุดู
# %%
gs.fit(train_features_transformed, train_target)
# %%
gs.best_params_
# %% md
# method2
# GridSearchCV
# ุฑูุด ุฏูู ฺฉู ุจูุชุฑู
# ุนุงู ููู
### ุจู ุงู ุฑูุด ุญุช ุงุจุฒุงุฑูุง ุชุฑูุณููุฑูุดู ูู ุงฺฏุฑ ูุงูพุฑ ูพุงุฑุงูุชุฑ ุฏุงุดุชู ุจุงุดู ุงููุง ุฑุง ูู ุจููู ูฺฉูุฏ
# %%
dt_regression_pipeline = Pipeline([
    ("transformation", all_transformations),
    ("dtr", DecisionTreeRegressor())
])
# %%
param_grid = {"transformation__rbf__kw_args": [{"Y": [[35.0]], "gamma": 0.1},
                                               {"Y": [[35.0]], "gamma": 0.2}],
              "dtr__max_depth": [5, 10, 15]}

# __rbf__kw_args ฺฉู ููุดุชู ุดุฏู ฺฉ ุงุฒ ูพุงุฑุงูุชุฑูุง ุฏุงุฎู ุชุฑูุณููุฑูุฑููู ุจูุฏ
# %%
gs = GridSearchCV(dt_regression_pipeline,
                  param_grid,
                  scoring="neg_mean_absolute_error",
                  cv=5)
# %%
gs.fit(train_features, train_target)
# %%
gs.best_params_
# %%
gs.cv_results_
# ุจุฑุง ุงูฺฉู ูุชุฌู ุณุฑฺ ูุง ฺฉู ุงูุฌุงู ุฏุงุฏู ุฑู ุจุจูู
# ฺฉู ุจูุชุฑู ุฏุงุฎู ฺฉ ุฏุชุง ูุฑู ุจุฑุฒู ฺฉู ุฏุฑ ุฎุท ุจุนุฏ ุงูุฌุงูุด ุฏุงุฏู
# %%
pd.DataFrame(gs.cv_results_).sort_values(by="mean_test_score",
                                         ascending=False)
# %% md
# method3
# RandomizedSearchCV
# ุฑูุด ุณูู ฺฉู ุจุฑุง ูุถุง ุจุฒุฑฺฏ ููุงุณุจู ู ููุฎูุงูู ุฎู ุฏูู ุจูุชุฑู ุฑุง ุงูุชุฎุงุจ ฺฉูู
#### ุจู ุตูุฑุช ุฑูุฏูู ุณุฑฺ ูฺฉูู
### ุจุฑุง ูุถุง ุจุฒุฑฺฏ ููุงุณุจู ฺูู ุฑูุด ูุจู ููฺฉูู ุฎู ุจุฒุฑฺฏ ุจุดู
"""
ุนู ุชูุงู ุญุงูุงุช ฺฉู ููฺฉูู ุฑู ุจุฑุฑุณ ูฺฉู ูุซูุง 10 ุชุง ุชุฑฺฉุจ ุฑุง ุจู ุตูุฑุช ุฑูุฏูู ุงูุชุฎุงุจ ฺฉู ู ุจูุชุฑู ุญุงูุช ุฑู ุจุฏู
 ฺฉู ุงู ููุฏุงุฑ ฺฉู ุงูุฌุง 10 ุงุณุช  ูพุงุฑุงูุชุฑ ุงุชุฑุดู ุงุณุช
"""
# %%
from scipy.stats import randint
from sklearn.model_selection import RandomizedSearchCV

# %%
dt_regression_pipeline = Pipeline([
    ("transformation", all_transformations),
    ("dtr", DecisionTreeRegressor())
])

# ุชุนุฑู ุชูุฒุนโูุง ุงุญุชูุงู ุจุฑุง ูพุงุฑุงูุชุฑูุง
param_distributions = {
    "dtr__max_depth": randint(5, 100),  # ุชูุฒุน ุงุนุฏุงุฏ ุชุตุงุฏู ุจู 5 ู 99 (100 ุดุงูู ููโุดูุฏ)
    "dtr__min_samples_split": randint(2, 20),
    "dtr__min_samples_leaf": randint(1, 10),
    "transformation__rbf__kw_args": [
        {"Y": [[35.0]], "gamma": 0.1},
        {"Y": [[35.0]], "gamma": 0.2},
        {"Y": [[35.0]], "gamma": 0.3},
        {"Y": [[35.0]], "gamma": 0.4}
    ]
}

# ุงุฌุงุฏ ู ุงุฌุฑุง RandomizedSearchCV
rs = RandomizedSearchCV(dt_regression_pipeline,
                        param_distributions,
                        n_iter=10,  # ุชุนุฏุงุฏ ุชฺฉุฑุงุฑูุง (ุชุนุฏุงุฏ ุชุฑฺฉุจโูุง ูพุงุฑุงูุชุฑูุง)
                        scoring="neg_mean_absolute_error",
                        cv=5,
                        random_state=42)  # ุจุฑุง ุชฺฉุฑุงุฑูพุฐุฑ

# ูุฑุถ ุจุฑ ุงู ุงุณุช ฺฉู train_features ู train_target ูุจูุงู ุชุนุฑู ุดุฏูโุงูุฏ
rs.fit(train_features, train_target)

# ููุงุด ุจูุชุฑู ูพุงุฑุงูุชุฑูุง
print(rs.best_params_)

# ููุงุด ุจูุชุฑู ุงูุชุงุฒ
print(rs.best_score_)
# %%
# ุญุงูุง ุจุง ุชูุฌู ุจู ุงูฺฉู ุจูุชุฑู ูพุงุฑุงูุชุฑูุง ุฑุง ุชูุณุท GridSearchCV ูพุฏุง ฺฉุฑุฏู ุง RandomizedSearchCV
# ุจูุชุฑู ูุฏู ุฑุง ุจุง ุงุณุชูุชูุฑ ูุจูู ฺฉู ฺ ูุณุช
# ููู ู ุนุงู ฺฉู ุฏุฑ ุฒุฑ ุจู ุตูุฑุช ุฒูพ ูุดูู ูุฏู ฺฉู ูุชูุฌู ุงููุชุด ูุดู
housing_model = gs.best_estimator_
housing_model["dtr"]
# %%
housing_model["dtr"].feature_importances_.round(3)
# ุงู ุฎุท ฺฉุฏ ูฺฏูุฏ ุจุฑุง ุงู ูุฏู ุงููุช ูฺุฑูุง ฺฉู ุฏุงุดุชู ฺูุฏุฑ ุจูุฏ
# round(3) ุชุง ุณู ุฑูู ุงุนุดุงุฑ ุฑูุฏุด ฺฉู
# %%
sorted(zip(housing_model["dtr"].feature_importances_.round(3),
           housing_model["transformation"].get_feature_names_out()),
       reverse=True)
# ุงฺฏุฑ ุฏุฑ ุฎุฑูุฌ ุฏูุช ฺฉูุฏ ูุซูุง np.float64(0.0) ุนู ุงู ูฺฺฏ ุจุฑุง ูุฏู ุงููุช ูุฏุงุดุชู
# ุงูุง ูุซูุง  (np.float64(0.055), 'log__median_income'), ุจุง ุชูุฌู ุจู ุนุฏุฏ 0.055 ุนู ุจุง ุงููุช ุจูุฏู
# %%
# ุงุฑุฒุงุจ ูุฏู ุฑู ุชุณุช
mean_squared_error(test_target,
                   housing_model.predict(test_features),
                   squared=False)

# ุณูุงู : ููู  ุจุฑุง squared ุงุฑูุฑ ูุฏู ุฏุฑ ุญุงู ฺฉู ูุณุฎู ุณุงฺฉุช ูุฑูู ูพุงู ูุณุช
# %% md
 #_________________________________________________________________________________________________________________________________________
# "ูุงุตูู ุงุทููุงู" (Confidence Interval)
"""
ุฏุฑ ุณุงฺฉุช-ููุฑู (scikit-learn)ุ ููููู "ูุงุตูู ุงุทููุงู" (Confidence Interval) ุจู ุทูุฑ ูุณุชูู ุจุฑุง ุชูุงู ูุฏูโูุง ุงุฏฺฏุฑ ูุงุดู ูพุงุฏูโุณุงุฒ ูุดุฏู ุงุณุช.
 ุจุง ุงู ุญุงูุ ุฑูุดโูุง ูุฌูุฏ ุฏุงุฑูุฏ ฺฉู ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุขูโูุงุ ููุงุตู ุงุทููุงู ุฑุง ุจุฑุง ูพุดโุจูโูุง ูุฏูโูุง ุณุงฺฉุช-ููุฑู ูุญุงุณุจู ฺฉูุฏ.

ุชุนุฑู ูุงุตูู ุงุทููุงู:

ูุงุตูู ุงุทููุงูุ ูุญุฏูุฏูโุง ุงุฒ ููุงุฏุฑ ุงุณุช ฺฉู ุจุง ุงุญุชูุงู ูุดุฎุตุ ููุฏุงุฑ ูุงูุน ฺฉ ูพุงุฑุงูุชุฑ ุง ูพุดโุจู ุฏุฑ ุขู ูุฑุงุฑ ูโฺฏุฑุฏ.
 ุจู ุนููุงู ูุซุงูุ ฺฉ ูุงุตูู ุงุทููุงู 95% ูุดุงู ูโุฏูุฏ ฺฉู ุงฺฏุฑ ุขุฒูุงุด ุฑุง ุจุงุฑูุง ุชฺฉุฑุงุฑ ฺฉููุ 95% ุงุฒ ููุงุตู ุงุทููุงู ูุญุงุณุจู ุดุฏูุ ููุฏุงุฑ ูุงูุน ุฑุง ุฏุฑ ุจุฑ ุฎูุงููุฏ ุฏุงุดุช.

ุฑูุดโูุง ูุญุงุณุจู ูุงุตูู ุงุทููุงู ุฏุฑ ุณุงฺฉุช-ููุฑู:

    ุฑูุด ุจูุชโุงุณุชุฑูพ (Bootstrap):
        ุงู ุฑูุด ฺฉ ุฑูุด ุบุฑูพุงุฑุงูุชุฑ ุงุณุช ฺฉู ุจุง ูููููโฺฏุฑ ูุฌุฏุฏ ุงุฒ ุฏุงุฏูโูุง ุงุตูุ ุชูุฒุน ุชุฎูู ุฒุฏู ุดุฏู ุฑุง ุจุฑุง ูพุงุฑุงูุชุฑ ุง ูพุดโุจู ูุญุงุณุจู ูโฺฉูุฏ.
        ุณูพุณุ ุงุฒ ุงู ุชูุฒุน ุจุฑุง ูุญุงุณุจู ูุงุตูู ุงุทููุงู ุงุณุชูุงุฏู ูโุดูุฏ.
        ุณุงฺฉุช-ููุฑู ุจู ุทูุฑ ูุณุชูู ุชุงุจุน ุจูุชโุงุณุชุฑูพ ุฑุง ุงุฑุงุฆู ููโุฏูุฏุ ุงูุง ูโุชูุงูุฏ ุงุฒ ฺฉุชุงุจุฎุงููโูุง ุฏฺฏุฑ ูุงููุฏ scipy.stats ุง statsmodels ุจุฑุง ูพุงุฏูโุณุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูุฏ.

    ุฑูุดโูุง ูพุงุฑุงูุชุฑ (ุจุฑุง ูุฏูโูุง ุฎุงุต):
        ุจุฑุฎ ูุฏูโูุง ุณุงฺฉุช-ููุฑูุ ูุงููุฏ ุฑฺฏุฑุณูู ุฎุทุ ุฑูุดโูุง ูพุงุฑุงูุชุฑ ุจุฑุง ูุญุงุณุจู ูุงุตูู ุงุทููุงู ุงุฑุงุฆู ูโุฏููุฏ.
        ุฏุฑ ุงู ุฑูุดโูุงุ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชูุฒุนโูุง ุขูุงุฑ ุดูุงุฎุชู ุดุฏู (ูุงููุฏ ุชูุฒุน t)ุ ูุงุตูู ุงุทููุงู ูุญุงุณุจู ูโุดูุฏ.
        ุจู ุนููุงู ูุซุงูุ ุฏุฑ ุฑฺฏุฑุณูู ุฎุทุ ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน statsmodels.OLSุ ููุงุตู ุงุทููุงู ุฑุง ุจุฑุง ุถุฑุงุจ ุฑฺฏุฑุณูู ูุญุงุณุจู ฺฉูุฏ.

    ุฑูุดโูุง ูุจุชู ุจุฑ ุฎุทุง ุจุงูโูุงูุฏู (Residual-based):
        ุงู ุฑูุดโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฎุทุงูุง ุจุงูโูุงูุฏู (ุชูุงูุช ุจู ููุงุฏุฑ ูุงูุน ู ูพุดโุจู ุดุฏู)ุ ุชูุฒุน ุฎุทุง ุฑุง ุชุฎูู ูโุฒููุฏ ู ุณูพุณ ุงุฒ ุงู ุชูุฒุน ุจุฑุง ูุญุงุณุจู ูุงุตูู ุงุทููุงู ุงุณุชูุงุฏู ูโฺฉููุฏ.
        ุงู ุฑูุดโูุง ูุนูููุงู ุจุฑุง ูุฏูโูุง ุฑฺฏุฑุณูู ุงุณุชูุงุฏู ูโุดููุฏ.
"""
# %%
from scipy import stats

# %%
ci = 0.95
# %%
se = (test_target.values - housing_model.predict(test_features)) ** 2
# %%
np.sqrt(stats.t.interval(ci,
                         len(se) - 1,
                         loc=np.mean(se),
                         scale=stats.sem(se)))
# %% md
 #_________________________________________________________________________________________________________________________________________
# ููุง ฺฉุฑุฏู ูุฏู
"""
ููุงุฑุฏ ุงุณุชูุงุฏู ุงุฒ joblib:

   -ุฐุฎุฑู ูุฏูโูุง ุงุฏฺฏุฑ ูุงุดู ุจุฑุง ุงุณุชูุงุฏู ูุฌุฏุฏ ุฏุฑ ุจุฑูุงููโูุง ุฏฺฏุฑ.
   -ุจู ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ูุฏูโูุง ุขููุฒุดโุฏุงุฏูโุดุฏู ุจุง ุฏฺฏุฑุงู.
   -ุฐุฎุฑู ู ุจุงุฑฺฏุฑ ุฏุงุฏูโูุง ุจุฒุฑฺฏ ุจู ุทูุฑ ฺฉุงุฑุขูุฏ.
   -ุงุฌุฑุง ูพุฑุฏุงุฒุด ูุง ููุงุฒ.

ูุงูโูุง .pkl ฺุณุชูุฏุ

   ูุงูโูุง .pkl ูุงูโูุง ูุณุชูุฏ ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุงฺูู pickle ุง ฺฉุชุงุจุฎุงูู joblib ุฏุฑ ูพุงุชูู ุงุฌุงุฏ ูโุดููุฏ.
   ุงู ููุน ูุงู ูุง ุจุฑุง ุฐุฎุฑู ุณุงุฒ ุจุงูุฑ ุฏุฑ ูพุงุชูู ุงุณุชูุงุฏู ู ุดููุฏ.
   ุขููุง ุญุงู ุณุฑุงูโุณุงุฒโุดุฏู ุงุดุงุก ูพุงุชูู ูุณุชูุฏุ ุจู ุงู ูุนู ฺฉู ุงุดุงุก ูพุงุชูู ุจู ฺฉ ูุงูุจ ูุงุจู ุฐุฎุฑู ู ุจุงุฒุงุจ ุชุจุฏู ูโุดููุฏ.
   ุจู ุทูุฑ ูุนูููุ ุงุฒ ูุงูโูุง .pkl ุจุฑุง ุฐุฎุฑู ูุฏูโูุง ุงุฏฺฏุฑ ูุงุดูุ ุฏุงุฏูโูุง ุจุฒุฑฺฏ ู ุณุงุฑ ุงุดุงุก ูพุงุชูู ุงุณุชูุงุฏู ูโุดูุฏ
"""
# %%
import joblib
#
# # %%
# joblib.dump(housing_model, "housing_model.pkl")
# # %%
# housing_model_loaded = joblib.load("housing_model.pkl")
# # %%
# housing_model_loaded
# %%

# %% md
 #_________________________________________________________________________________________________________________________________________
### ML operations (MLOps)